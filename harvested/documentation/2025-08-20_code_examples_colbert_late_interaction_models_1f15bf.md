---
agent_context: architect
confidence: 0.95
harvested_at: '2025-08-20T13:11:16.747302'
profile: code_examples
source: https://github.com/stanford-futuredata/ColBERT
topic: ColBERT Late Interaction Models
---

# ColBERT Late Interaction Models

[Skip to content](https://github.com/stanford-futuredata/ColBERT#start-of-content)
## Navigation Menu
Toggle navigation
[ ](https://github.com/)
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fstanford-futuredata%2FColBERT)
Appearance settings
  * Product 
    * [ GitHub Copilot  Write better code with AI  ](https://github.com/features/copilot)
    * [ GitHub Spark  New  Build and deploy intelligent apps  ](https://github.com/features/spark)
    * [ GitHub Models  New  Manage and compare prompts  ](https://github.com/features/models)
    * [ GitHub Advanced Security  Find and fix vulnerabilities  ](https://github.com/security/advanced-security)
    * [ Actions  Automate any workflow  ](https://github.com/features/actions)
    * [ Codespaces  Instant dev environments  ](https://github.com/features/codespaces)
    * [ Issues  Plan and track work  ](https://github.com/features/issues)
    * [ Code Review  Manage code changes  ](https://github.com/features/code-review)
    * [ Discussions  Collaborate outside of code  ](https://github.com/features/discussions)
    * [ Code Search  Find more, search less  ](https://github.com/features/code-search)
Explore
    * [ Why GitHub ](https://github.com/why-github)
    * [ All features ](https://github.com/features)
    * [ Documentation ](https://docs.github.com)
    * [ GitHub Skills ](https://skills.github.com)
    * [ Blog ](https://github.blog)
  * Solutions 
By company size
    * [ Enterprises ](https://github.com/enterprise)
    * [ Small and medium teams ](https://github.com/team)
    * [ Startups ](https://github.com/enterprise/startups)
    * [ Nonprofits ](https://github.com/solutions/industry/nonprofits)
By use case
    * [ DevSecOps ](https://github.com/solutions/use-case/devsecops)
    * [ DevOps ](https://github.com/solutions/use-case/devops)
    * [ CI/CD ](https://github.com/solutions/use-case/ci-cd)
    * [ View all use cases ](https://github.com/solutions/use-case)
By industry
    * [ Healthcare ](https://github.com/solutions/industry/healthcare)
    * [ Financial services ](https://github.com/solutions/industry/financial-services)
    * [ Manufacturing ](https://github.com/solutions/industry/manufacturing)
    * [ Government ](https://github.com/solutions/industry/government)
    * [ View all industries ](https://github.com/solutions/industry)
[ View all solutions ](https://github.com/solutions)
  * Resources 
Topics
    * [ AI ](https://github.com/resources/articles/ai)
    * [ DevOps ](https://github.com/resources/articles/devops)
    * [ Security ](https://github.com/resources/articles/security)
    * [ Software Development ](https://github.com/resources/articles/software-development)
    * [ View all ](https://github.com/resources/articles)
Explore
    * [ Learning Pathways ](https://resources.github.com/learn/pathways)
    * [ Events & Webinars ](https://resources.github.com)
    * [ Ebooks & Whitepapers ](https://github.com/resources/whitepapers)
    * [ Customer Stories ](https://github.com/customer-stories)
    * [ Partners ](https://partner.github.com)
    * [ Executive Insights ](https://github.com/solutions/executive-insights)
  * Open Source 
    * [ GitHub Sponsors  Fund open source developers  ](https://github.com/sponsors)
    * [ The ReadME Project  GitHub community articles  ](https://github.com/readme)
Repositories
    * [ Topics ](https://github.com/topics)
    * [ Trending ](https://github.com/trending)
    * [ Collections ](https://github.com/collections)
  * Enterprise 
    * [ Enterprise platform  AI-powered developer platform  ](https://github.com/enterprise)
Available add-ons
    * [ GitHub Advanced Security  Enterprise-grade security features  ](https://github.com/security/advanced-security)
    * [ Copilot for business  Enterprise-grade AI features  ](https://github.com/features/copilot/copilot-business)
    * [ Premium Support  Enterprise-grade 24/7 support  ](https://github.com/premium-support)
  * [Pricing](https://github.com/pricing)


Search or jump to...
# Search code, repositories, users, issues, pull requests...
Search 
Clear
[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)
#  Provide feedback 
We read every piece of feedback, and take your input very seriously.
Include my email address so I can be contacted
Cancel  Submit feedback 
#  Saved searches 
## Use saved searches to filter your results more quickly
Name
Query
To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax). 
Cancel  Create saved search 
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fstanford-futuredata%2FColBERT)
[ Sign up ](https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=stanford-futuredata%2FColBERT)
Appearance settings
Resetting focus
You signed in with another tab or window. [Reload](https://github.com/stanford-futuredata/ColBERT) to refresh your session. You signed out in another tab or window. [Reload](https://github.com/stanford-futuredata/ColBERT) to refresh your session. You switched accounts on another tab or window. [Reload](https://github.com/stanford-futuredata/ColBERT) to refresh your session. Dismiss alert
{{ message }}
[ stanford-futuredata ](https://github.com/stanford-futuredata) / **[ColBERT](https://github.com/stanford-futuredata/ColBERT) ** Public
  * [ Notifications ](https://github.com/login?return_to=%2Fstanford-futuredata%2FColBERT) You must be signed in to change notification settings
  * [ Fork 446 ](https://github.com/login?return_to=%2Fstanford-futuredata%2FColBERT)
  * [ Star  3.6k ](https://github.com/login?return_to=%2Fstanford-futuredata%2FColBERT)


ColBERT: state-of-the-art neural search (SIGIR'20, TACL'21, NeurIPS'21, NAACL'22, CIKM'22, ACL'23, EMNLP'23) 
### License
[ MIT license ](https://github.com/stanford-futuredata/ColBERT/blob/main/LICENSE)
[ 3.6k stars ](https://github.com/stanford-futuredata/ColBERT/stargazers) [ 446 forks ](https://github.com/stanford-futuredata/ColBERT/forks) [ Branches ](https://github.com/stanford-futuredata/ColBERT/branches) [ Tags ](https://github.com/stanford-futuredata/ColBERT/tags) [ Activity ](https://github.com/stanford-futuredata/ColBERT/activity)
[ Star  ](https://github.com/login?return_to=%2Fstanford-futuredata%2FColBERT)
[ Notifications ](https://github.com/login?return_to=%2Fstanford-futuredata%2FColBERT) You must be signed in to change notification settings
  * [ Code ](https://github.com/stanford-futuredata/ColBERT)
  * [ Issues 88 ](https://github.com/stanford-futuredata/ColBERT/issues)
  * [ Pull requests 20 ](https://github.com/stanford-futuredata/ColBERT/pulls)
  * [ Discussions ](https://github.com/stanford-futuredata/ColBERT/discussions)
  * [ Actions ](https://github.com/stanford-futuredata/ColBERT/actions)
  * [ Projects 0 ](https://github.com/stanford-futuredata/ColBERT/projects)
  * [ Security ](https://github.com/stanford-futuredata/ColBERT/security)
[ ](https://github.com/stanford-futuredata/ColBERT/security)
[ ](https://github.com/stanford-futuredata/ColBERT/security)
[ ](https://github.com/stanford-futuredata/ColBERT/security)
### [ Uh oh!  ](https://github.com/stanford-futuredata/ColBERT/security)
[There was an error while loading. ](https://github.com/stanford-futuredata/ColBERT/security)[Please reload this page](https://github.com/stanford-futuredata/ColBERT).
  * [ Insights ](https://github.com/stanford-futuredata/ColBERT/pulse)


Additional navigation options
  * [ Code  ](https://github.com/stanford-futuredata/ColBERT)
  * [ Issues  ](https://github.com/stanford-futuredata/ColBERT/issues)
  * [ Pull requests  ](https://github.com/stanford-futuredata/ColBERT/pulls)
  * [ Discussions  ](https://github.com/stanford-futuredata/ColBERT/discussions)
  * [ Actions  ](https://github.com/stanford-futuredata/ColBERT/actions)
  * [ Projects  ](https://github.com/stanford-futuredata/ColBERT/projects)
  * [ Security  ](https://github.com/stanford-futuredata/ColBERT/security)
  * [ Insights  ](https://github.com/stanford-futuredata/ColBERT/pulse)


# stanford-futuredata/ColBERT
main
[Branches](https://github.com/stanford-futuredata/ColBERT/branches)[Tags](https://github.com/stanford-futuredata/ColBERT/tags)
[](https://github.com/stanford-futuredata/ColBERT/branches)[](https://github.com/stanford-futuredata/ColBERT/tags)
Go to file
Code
Open more actions menu
## Folders and files
Name| Name| Last commit message| Last commit date  
---|---|---|---  
## Latest commit
## History
[360 Commits](https://github.com/stanford-futuredata/ColBERT/commits/main/)[](https://github.com/stanford-futuredata/ColBERT/commits/main/)  
[baleen](https://github.com/stanford-futuredata/ColBERT/tree/main/baleen "baleen")| [baleen](https://github.com/stanford-futuredata/ColBERT/tree/main/baleen "baleen")| |   
[colbert](https://github.com/stanford-futuredata/ColBERT/tree/main/colbert "colbert")| [colbert](https://github.com/stanford-futuredata/ColBERT/tree/main/colbert "colbert")| |   
[data](https://github.com/stanford-futuredata/ColBERT/tree/main/data "data")| [data](https://github.com/stanford-futuredata/ColBERT/tree/main/data "data")| |   
[docs](https://github.com/stanford-futuredata/ColBERT/tree/main/docs "docs")| [docs](https://github.com/stanford-futuredata/ColBERT/tree/main/docs "docs")| |   
[utility](https://github.com/stanford-futuredata/ColBERT/tree/main/utility "utility")| [utility](https://github.com/stanford-futuredata/ColBERT/tree/main/utility "utility")| |   
[.env](https://github.com/stanford-futuredata/ColBERT/blob/main/.env ".env")| [.env](https://github.com/stanford-futuredata/ColBERT/blob/main/.env ".env")| |   
[.gitignore](https://github.com/stanford-futuredata/ColBERT/blob/main/.gitignore ".gitignore")| [.gitignore](https://github.com/stanford-futuredata/ColBERT/blob/main/.gitignore ".gitignore")| |   
[LICENSE](https://github.com/stanford-futuredata/ColBERT/blob/main/LICENSE "LICENSE")| [LICENSE](https://github.com/stanford-futuredata/ColBERT/blob/main/LICENSE "LICENSE")| |   
[LoTTE.md](https://github.com/stanford-futuredata/ColBERT/blob/main/LoTTE.md "LoTTE.md")| [LoTTE.md](https://github.com/stanford-futuredata/ColBERT/blob/main/LoTTE.md "LoTTE.md")| |   
[MANIFEST.in](https://github.com/stanford-futuredata/ColBERT/blob/main/MANIFEST.in "MANIFEST.in")| [MANIFEST.in](https://github.com/stanford-futuredata/ColBERT/blob/main/MANIFEST.in "MANIFEST.in")| |   
[README.md](https://github.com/stanford-futuredata/ColBERT/blob/main/README.md "README.md")| [README.md](https://github.com/stanford-futuredata/ColBERT/blob/main/README.md "README.md")| |   
[ROADMAP.md](https://github.com/stanford-futuredata/ColBERT/blob/main/ROADMAP.md "ROADMAP.md")| [ROADMAP.md](https://github.com/stanford-futuredata/ColBERT/blob/main/ROADMAP.md "ROADMAP.md")| |   
[conda_env.yml](https://github.com/stanford-futuredata/ColBERT/blob/main/conda_env.yml "conda_env.yml")| [conda_env.yml](https://github.com/stanford-futuredata/ColBERT/blob/main/conda_env.yml "conda_env.yml")| |   
[conda_env_cpu.yml](https://github.com/stanford-futuredata/ColBERT/blob/main/conda_env_cpu.yml "conda_env_cpu.yml")| [conda_env_cpu.yml](https://github.com/stanford-futuredata/ColBERT/blob/main/conda_env_cpu.yml "conda_env_cpu.yml")| |   
[server.py](https://github.com/stanford-futuredata/ColBERT/blob/main/server.py "server.py")| [server.py](https://github.com/stanford-futuredata/ColBERT/blob/main/server.py "server.py")| |   
[setup.py](https://github.com/stanford-futuredata/ColBERT/blob/main/setup.py "setup.py")| [setup.py](https://github.com/stanford-futuredata/ColBERT/blob/main/setup.py "setup.py")| |   
View all files  
## Repository files navigation
  * [README](https://github.com/stanford-futuredata/ColBERT)
  * [MIT license](https://github.com/stanford-futuredata/ColBERT)


[![](https://github.com/stanford-futuredata/ColBERT/raw/main/docs/images/colbertofficial.png)](https://github.com/stanford-futuredata/ColBERT/blob/main/docs/images/colbertofficial.png)
# ColBERT (v2)
[](https://github.com/stanford-futuredata/ColBERT#colbert-v2)
### ColBERT is a _fast_ and _accurate_ retrieval model, enabling scalable BERT-based search over large text collections in tens of milliseconds.
[](https://github.com/stanford-futuredata/ColBERT#colbert-is-a-fast-and-accurate-retrieval-model-enabling-scalable-bert-based-search-over-large-text-collections-in-tens-of-milliseconds)
[![](https://camo.githubusercontent.com/96889048f8a9014fdeba2a891f97150c6aac6e723f5190236b10215a97ed41f3/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667)](https://colab.research.google.com/github/stanford-futuredata/ColBERT/blob/main/docs/intro2new.ipynb)
[![](https://github.com/stanford-futuredata/ColBERT/raw/main/docs/images/ColBERT-Framework-MaxSim-W370px.png)](https://github.com/stanford-futuredata/ColBERT/blob/main/docs/images/ColBERT-Framework-MaxSim-W370px.png)
**Figure 1:** ColBERT's late interaction, efficiently scoring the fine-grained similarity between a queries and a passage. 
As Figure 1 illustrates, ColBERT relies on fine-grained **contextual late interaction** : it encodes each passage into a **matrix** of token-level embeddings (shown above in blue). Then at search time, it embeds every query into another matrix (shown in green) and efficiently finds passages that contextually match the query using scalable vector-similarity (`MaxSim`) operators.
These rich interactions allow ColBERT to surpass the quality of _single-vector_ representation models, while scaling efficiently to large corpora.
#### You can read more in our papers:
[](https://github.com/stanford-futuredata/ColBERT#you-can-read-more-in-our-papers)
  * [**ColBERT: Efficient and Effective Passage Search via Contextualized Late Interaction over BERT**](https://arxiv.org/abs/2004.12832) (SIGIR'20).
  * [**Relevance-guided Supervision for OpenQA with ColBERT**](https://arxiv.org/abs/2007.00814) (TACL'21).
  * [**Baleen: Robust Multi-Hop Reasoning at Scale via Condensed Retrieval**](https://arxiv.org/abs/2101.00436) (NeurIPS'21).
  * [**ColBERTv2: Effective and Efficient Retrieval via Lightweight Late Interaction**](https://arxiv.org/abs/2112.01488) (NAACL'22).
  * [**PLAID: An Efficient Engine for Late Interaction Retrieval**](https://arxiv.org/abs/2205.09707) (CIKM'22).
  * [**Moving Beyond Downstream Task Accuracy for Information Retrieval Benchmarking**](https://arxiv.org/abs/2212.01340) (ACL'23 Findings).
  * [**UDAPDR: Unsupervised Domain Adaptation via LLM Prompting and Distillation of Rerankers**](https://arxiv.org/abs/2303.00807) (EMNLP'23).


## ðŸš¨ **Announcements**
[](https://github.com/stanford-futuredata/ColBERT#-announcements)
  * (1/28/24) One of the easiest ways to use ColBERT in applications nowadays is the semi-official, fast-growing [RAGatouille](https://github.com/bclavie/ragatouille) library.
  * (1/29/23) We have merged a new index updater feature and support for additional Hugging Face models! These are in beta so please give us feedback as you try them out.
  * (1/24/23) If you're looking for the **DSPy** framework for composing retrievers like ColBERTv2 and LLMs, it's at: <https://github.com/stanfordnlp/dspy>


## ColBERTv1
[](https://github.com/stanford-futuredata/ColBERT#colbertv1)
The ColBERTv1 code from the SIGIR'20 paper is in the [`colbertv1` branch](https://github.com/stanford-futuredata/ColBERT/tree/colbertv1). See [here](https://github.com/stanford-futuredata/ColBERT#branches) for more information on other branches.
## Installation
[](https://github.com/stanford-futuredata/ColBERT#installation)
(Update: nowadays you can typically do `pip install colbert-ai[torch,faiss-gpu]` to get things up and running, but if you face issues conda is always more reliable for `faiss` and `torch`.)
ColBERT requires Python 3.7+ and Pytorch 1.9+ and uses the [Hugging Face Transformers](https://github.com/huggingface/transformers) library.
We strongly recommend creating a conda environment using the commands below. (If you don't have conda, follow the official [conda installation guide](https://docs.anaconda.com/anaconda/install/linux/#installation).)
We have also included a new environment file specifically for CPU-only environments (`conda_env_cpu.yml`), but note that if you are testing CPU execution on a machine that includes GPUs you might need to specify `CUDA_VISIBLE_DEVICES=""` as part of your command. Note that a GPU is required for training and indexing.
```
conda env create -f conda_env[_cpu].yml
conda activate colbert

```

If you face any problems, please [open a new issue](https://github.com/stanford-futuredata/ColBERT/issues) and we'll help you promptly!
## Overview
[](https://github.com/stanford-futuredata/ColBERT#overview)
Using ColBERT on a dataset typically involves the following steps.
**Step 0: Preprocess your collection.** At its simplest, ColBERT works with tab-separated (TSV) files: a file (e.g., `collection.tsv`) will contain all passages and another (e.g., `queries.tsv`) will contain a set of queries for searching the collection.
**Step 1: Download the[pre-trained ColBERTv2 checkpoint](https://downloads.cs.stanford.edu/nlp/data/colbert/colbertv2/colbertv2.0.tar.gz).** This checkpoint has been trained on the MS MARCO Passage Ranking task. You can also _optionally_ [train your own ColBERT model](https://github.com/stanford-futuredata/ColBERT#training).
**Step 2: Index your collection.** Once you have a trained ColBERT model, you need to [index your collection](https://github.com/stanford-futuredata/ColBERT#indexing) to permit fast retrieval. This step encodes all passages into matrices, stores them on disk, and builds data structures for efficient search.
**Step 3: Search the collection with your queries.** Given the model and index, you can [issue queries over the collection](https://github.com/stanford-futuredata/ColBERT#retrieval) to retrieve the top-k passages for each query.
Below, we illustrate these steps via an example run on the MS MARCO Passage Ranking task.
## API Usage Notebook
[](https://github.com/stanford-futuredata/ColBERT#api-usage-notebook)
**NEW** : We have an experimental notebook on [Google Colab](https://colab.research.google.com/github/stanford-futuredata/ColBERT/blob/main/docs/intro2new.ipynb) that you can use with free GPUs. Indexing 10,000 on the free Colab T4 GPU takes six minutes.
This Jupyter notebook **[docs/intro.ipynb notebook](https://github.com/stanford-futuredata/ColBERT/blob/main/docs/intro.ipynb)** illustrates using the key features of ColBERT with the new Python API.
It includes how to download the ColBERTv2 model checkpoint trained on MS MARCO Passage Ranking and how to download our new LoTTE benchmark.
## Data
[](https://github.com/stanford-futuredata/ColBERT#data)
This repository works directly with a simple **tab-separated file** format to store queries, passages, and top-k ranked lists.
  * Queries: each line is `qid \t query text`.
  * Collection: each line is `pid \t passage text`.
  * Top-k Ranking: each line is `qid \t pid \t rank`.


This works directly with the data format of the [MS MARCO Passage Ranking](https://github.com/microsoft/MSMARCO-Passage-Ranking) dataset. You will need the training triples (`triples.train.small.tar.gz`), the official top-1000 ranked lists for the dev set queries (`top1000.dev`), and the dev set relevant passages (`qrels.dev.small.tsv`). For indexing the full collection, you will also need the list of passages (`collection.tar.gz`).
## Indexing
[](https://github.com/stanford-futuredata/ColBERT#indexing)
For fast retrieval, indexing precomputes the ColBERT representations of passages.
Example usage:
```
from colbert.infra import Run, RunConfig, ColBERTConfig
from colbert import Indexer
if __name__=='__main__':
  with Run().context(RunConfig(nranks=1, experiment="msmarco")):
    config = ColBERTConfig(
      nbits=2,
      root="/path/to/experiments",
    )
    indexer = Indexer(checkpoint="/path/to/checkpoint", config=config)
    indexer.index(name="msmarco.nbits=2", collection="/path/to/MSMARCO/collection.tsv")
```

## Retrieval
[](https://github.com/stanford-futuredata/ColBERT#retrieval)
We typically recommend that you use ColBERT for **end-to-end** retrieval, where it directly finds its top-k passages from the full collection:
```
from colbert.data import Queries
from colbert.infra import Run, RunConfig, ColBERTConfig
from colbert import Searcher
if __name__=='__main__':
  with Run().context(RunConfig(nranks=1, experiment="msmarco")):
    config = ColBERTConfig(
      root="/path/to/experiments",
    )
    searcher = Searcher(index="msmarco.nbits=2", config=config)
    queries = Queries("/path/to/MSMARCO/queries.dev.small.tsv")
    ranking = searcher.search_all(queries, k=100)
    ranking.save("msmarco.nbits=2.ranking.tsv")
```

You can optionally specify the `ncells`, `centroid_score_threshold`, and `ndocs` search hyperparameters to trade off between speed and result quality. Defaults for different values of `k` are listed in colbert/searcher.py.
We can evaluate the MSMARCO rankings using the following command:
```
python -m utility.evaluate.msmarco_passages --ranking "/path/to/msmarco.nbits=2.ranking.tsv" --qrels "/path/to/MSMARCO/qrels.dev.small.tsv"

```

## Basic Training (ColBERTv1-style)
[](https://github.com/stanford-futuredata/ColBERT#basic-training-colbertv1-style)
We provide a [pre-trained model checkpoint](https://downloads.cs.stanford.edu/nlp/data/colbert/colbertv2/colbertv2.0.tar.gz), but we also detail how to train from scratch here. Note that this example demonstrates the ColBERTv1 style of training, but the provided checkpoint was trained with ColBERTv2.
Training requires a JSONL triples file with a `[qid, pid+, pid-]` list per line. The query IDs and passage IDs correspond to the specified `queries.tsv` and `collection.tsv` files respectively.
Example usage (training on 4 GPUs):
```
from colbert.infra import Run, RunConfig, ColBERTConfig
from colbert import Trainer
if __name__=='__main__':
  with Run().context(RunConfig(nranks=4, experiment="msmarco")):
    config = ColBERTConfig(
      bsize=32,
      root="/path/to/experiments",
    )
    trainer = Trainer(
      triples="/path/to/MSMARCO/triples.train.small.tsv",
      queries="/path/to/MSMARCO/queries.train.small.tsv",
      collection="/path/to/MSMARCO/collection.tsv",
      config=config,
    )
    checkpoint_path = trainer.train()
    print(f"Saved checkpoint to {checkpoint_path}...")
```

## Advanced Training (ColBERTv2-style)
[](https://github.com/stanford-futuredata/ColBERT#advanced-training-colbertv2-style)
```
from colbert.infra.run import Run
from colbert.infra.config import ColBERTConfig, RunConfig
from colbert import Trainer

def train():
  # use 4 gpus (e.g. four A100s, but you can use fewer by changing nway,accumsteps,bsize).
  with Run().context(RunConfig(nranks=4)):
    triples = '/path/to/examples.64.json' # `wget https://huggingface.co/colbert-ir/colbertv2.0_msmarco_64way/resolve/main/examples.json?download=true` (26GB)
    queries = '/path/to/MSMARCO/queries.train.tsv'
    collection = '/path/to/MSMARCO/collection.tsv'
    config = ColBERTConfig(bsize=32, lr=1e-05, warmup=20_000, doc_maxlen=180, dim=128, attend_to_mask_tokens=False, nway=64, accumsteps=1, similarity='cosine', use_ib_negatives=True)
    trainer = Trainer(triples=triples, queries=queries, collection=collection, config=config)
    trainer.train(checkpoint='colbert-ir/colbertv1.9') # or start from scratch, like `bert-base-uncased`

if __name__ == '__main__':
  train()
```

## Running a lightweight ColBERTv2 server
[](https://github.com/stanford-futuredata/ColBERT#running-a-lightweight-colbertv2-server)
We provide a script to run a lightweight server which serves k (upto 100) results in ranked order for a given search query, in JSON format. This script can be used to power DSP programs.
To run the server, update the environment variables `INDEX_ROOT` and `INDEX_NAME` in the `.env` file to point to the appropriate ColBERT index. The run the following command:
```
python server.py

```

A sample query:
```
http://localhost:8893/api/search?query=Who won the 2022 FIFA world cup&k=25

```

## Branches
[](https://github.com/stanford-futuredata/ColBERT#branches)
### Supported branches
[](https://github.com/stanford-futuredata/ColBERT#supported-branches)
  * [`main`](https://github.com/stanford-futuredata/ColBERT/tree/main): Stable branch with ColBERTv2 + PLAID.
  * [`colbertv1`](https://github.com/stanford-futuredata/ColBERT/tree/colbertv1): Legacy branch for ColBERTv1.


### Deprecated branches
[](https://github.com/stanford-futuredata/ColBERT#deprecated-branches)
  * [`new_api`](https://github.com/stanford-futuredata/ColBERT/tree/new_api): Base ColBERTv2 implementation.
  * [`cpu_inference`](https://github.com/stanford-futuredata/ColBERT/tree/cpu_inference): ColBERTv2 implementation with CPU search support.
  * [`fast_search`](https://github.com/stanford-futuredata/ColBERT/tree/fast_search): ColBERTv2 implementation with PLAID.
  * [`binarization`](https://github.com/stanford-futuredata/ColBERT/tree/binarization): ColBERT with a baseline binarization-based compression strategy (as opposed to ColBERTv2's residual compression, which we found to be more robust).


## Acknowledgments
[](https://github.com/stanford-futuredata/ColBERT#acknowledgments)
ColBERT logo designed by Chuyi Zhang.
## About
ColBERT: state-of-the-art neural search (SIGIR'20, TACL'21, NeurIPS'21, NAACL'22, CIKM'22, ACL'23, EMNLP'23) 
### Resources
[ Readme ](https://github.com/stanford-futuredata/ColBERT#readme-ov-file)
### License
[ MIT license ](https://github.com/stanford-futuredata/ColBERT#MIT-1-ov-file)
###  Uh oh! 
There was an error while loading. [Please reload this page](https://github.com/stanford-futuredata/ColBERT).
[ Activity](https://github.com/stanford-futuredata/ColBERT/activity)
[ Custom properties](https://github.com/stanford-futuredata/ColBERT/custom-properties)
### Stars
[ **3.6k** stars](https://github.com/stanford-futuredata/ColBERT/stargazers)
### Watchers
[ **45** watching](https://github.com/stanford-futuredata/ColBERT/watchers)
### Forks
[ **446** forks](https://github.com/stanford-futuredata/ColBERT/forks)
[ Report repository ](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fstanford-futuredata%2FColBERT&report=stanford-futuredata+%28user%29)
##  [Used by 1k](https://github.com/stanford-futuredata/ColBERT/network/dependents)
[
  * ![@akdombrowski](https://avatars.githubusercontent.com/u/14928069?s=64&v=4)
  * ![@NotNullTeam](https://avatars.githubusercontent.com/u/219504870?s=64&v=4)
  * ![@NotNullTeam](https://avatars.githubusercontent.com/u/219504870?s=64&v=4)
  * ![@themarcosf](https://avatars.githubusercontent.com/u/84358344?s=64&v=4)
  * ![@NYU-ITS](https://avatars.githubusercontent.com/u/162509670?s=64&v=4)
  * ![@WRLDInc](https://avatars.githubusercontent.com/u/56140573?s=64&v=4)
  * ![@passariello](https://avatars.githubusercontent.com/u/17809213?s=64&v=4)
  * ![@DarksunTv](https://avatars.githubusercontent.com/u/124518323?s=64&v=4)

+ 997  ](https://github.com/stanford-futuredata/ColBERT/network/dependents)
##  [Contributors 33](https://github.com/stanford-futuredata/ColBERT/graphs/contributors)
  * [ ![@okhat](https://avatars.githubusercontent.com/u/963532?s=64&v=4) ](https://github.com/okhat)
  * [ ![@santhnm2](https://avatars.githubusercontent.com/u/5347982?s=64&v=4) ](https://github.com/santhnm2)
  * [ ![@jonsaadfalcon](https://avatars.githubusercontent.com/u/41205309?s=64&v=4) ](https://github.com/jonsaadfalcon)
  * [ ![@bclavie](https://avatars.githubusercontent.com/u/16307635?s=64&v=4) ](https://github.com/bclavie)
  * [ ![@hichewss](https://avatars.githubusercontent.com/u/108964828?s=64&v=4) ](https://github.com/hichewss)
  * [ ![@Anmol6](https://avatars.githubusercontent.com/u/13502307?s=64&v=4) ](https://github.com/Anmol6)
  * [ ![@jessiejuachon](https://avatars.githubusercontent.com/u/5719531?s=64&v=4) ](https://github.com/jessiejuachon)
  * [ ![@JoshuaPurtell](https://avatars.githubusercontent.com/u/32282839?s=64&v=4) ](https://github.com/JoshuaPurtell)
  * [ ![@NohTow](https://avatars.githubusercontent.com/u/38869395?s=64&v=4) ](https://github.com/NohTow)
  * [ ![@cmacdonald](https://avatars.githubusercontent.com/u/620938?s=64&v=4) ](https://github.com/cmacdonald)
  * [ ![@xm-gui](https://avatars.githubusercontent.com/u/9771029?s=64&v=4) ](https://github.com/xm-gui)
  * [ ![@liuqi6777](https://avatars.githubusercontent.com/u/72511133?s=64&v=4) ](https://github.com/liuqi6777)
  * [ ![@vishalbakshi](https://avatars.githubusercontent.com/u/28925987?s=64&v=4) ](https://github.com/vishalbakshi)
  * [ ![@udingankar](https://avatars.githubusercontent.com/u/116251307?s=64&v=4) ](https://github.com/udingankar)


[+ 19 contributors](https://github.com/stanford-futuredata/ColBERT/graphs/contributors)
## Languages
  * [ Python 93.3% ](https://github.com/stanford-futuredata/ColBERT/search?l=python)
  * [ C++ 5.5% ](https://github.com/stanford-futuredata/ColBERT/search?l=c%2B%2B)
  * [ Cuda 1.2% ](https://github.com/stanford-futuredata/ColBERT/search?l=cuda)


## Footer
[ ](https://github.com) Â© 2025 GitHub, Inc. 
### Footer navigation
  * [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
  * [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Docs](https://docs.github.com/)
  * [Contact](https://support.github.com?tags=dotcom-footer)
  * Manage cookies 
  * Do not share my personal information 


You canâ€™t perform that action at this time. 


## Source Information
- URL: https://github.com/stanford-futuredata/ColBERT
- Harvested: 2025-08-20T13:11:16.747302
- Profile: code_examples
- Agent: architect
