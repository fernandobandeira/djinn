---
agent_context: architect
confidence: 0.95
harvested_at: '2025-08-19T12:37:25.249290'
profile: api_documentation
source: https://huggingface.co/docs/transformers/model_doc/llama2
topic: Free AI models Llama and alternatives
---

# Free AI models Llama and alternatives

[![Hugging Face's logo](https://huggingface.co/front/assets/huggingface_logo-noborder.svg) Hugging Face](https://huggingface.co/)
  * [ Models](https://huggingface.co/models)
  * [ Datasets](https://huggingface.co/datasets)
  * [ Spaces](https://huggingface.co/spaces)
  * Community 
  * [ Docs](https://huggingface.co/docs)
  * [ Enterprise](https://huggingface.co/enterprise)
  * [Pricing](https://huggingface.co/pricing)
  * [Log In](https://huggingface.co/login)
  * [Sign Up](https://huggingface.co/join)


Transformers documentation
Llama 2
# Transformers
üè° View all docsAWS Trainium & InferentiaAccelerateArgillaAutoTrainBitsandbytesChat UIDataset viewerDatasetsDeploying on AWSDiffusersDistilabelEvaluateGradioHubHub Python LibraryHuggingface.jsInference Endpoints (dedicated)Inference ProvidersLeRobotLeaderboardsLightevalMicrosoft AzureOptimumPEFTSafetensorsSentence TransformersTRLTasksText Embeddings InferenceText Generation InferenceTokenizersTransformersTransformers.jssmolagentstimm
Search documentation
`Ctrl+K`
mainv4.53.3v4.52.3v4.51.3v4.50.0v4.49.0v4.48.2v4.47.1v4.46.3v4.45.2v4.44.2v4.43.4v4.42.4v4.41.2v4.40.2v4.39.3v4.38.2v4.37.2v4.36.1v4.35.2v4.34.1v4.33.3v4.32.1v4.31.0v4.30.0v4.29.1v4.28.1v4.27.2v4.26.1v4.25.1v4.24.0v4.23.1v4.22.2v4.21.3v4.20.1v4.19.4v4.18.0v4.17.0v4.16.2v4.15.0v4.14.1v4.13.0v4.12.5v4.11.3v4.10.1v4.9.2v4.8.2v4.7.0v4.6.0v4.5.1v4.4.2v4.3.3v4.2.2v4.1.1v4.0.1v3.5.1v3.4.0v3.3.1v3.2.0v3.1.0v3.0.2v2.11.0v2.10.0v2.9.1v2.8.0v2.7.0v2.6.0v2.5.1v2.4.1v2.3.0v2.2.2v2.1.1v2.0.0v1.2.0v1.1.0v1.0.0doc-builder-html ARDEENESFRHIITJAKOPTTETRZH [ 148,515](https://github.com/huggingface/transformers)
Get started
[Transformers ](https://huggingface.co/docs/transformers/index)[Installation ](https://huggingface.co/docs/transformers/installation)[Quickstart ](https://huggingface.co/docs/transformers/quicktour)
Base classes
Inference
Training
Quantization
Export to production
Resources
Contribute
API
Main Classes
Models
Text models
[ALBERT ](https://huggingface.co/docs/transformers/model_doc/albert)[Arcee ](https://huggingface.co/docs/transformers/model_doc/arcee)[Bamba ](https://huggingface.co/docs/transformers/model_doc/bamba)[BART ](https://huggingface.co/docs/transformers/model_doc/bart)[BARThez ](https://huggingface.co/docs/transformers/model_doc/barthez)[BARTpho ](https://huggingface.co/docs/transformers/model_doc/bartpho)[BERT ](https://huggingface.co/docs/transformers/model_doc/bert)[BertGeneration ](https://huggingface.co/docs/transformers/model_doc/bert-generation)[BertJapanese ](https://huggingface.co/docs/transformers/model_doc/bert-japanese)[BERTweet ](https://huggingface.co/docs/transformers/model_doc/bertweet)[BigBird ](https://huggingface.co/docs/transformers/model_doc/big_bird)[BigBirdPegasus ](https://huggingface.co/docs/transformers/model_doc/bigbird_pegasus)[BioGpt ](https://huggingface.co/docs/transformers/model_doc/biogpt)[BitNet ](https://huggingface.co/docs/transformers/model_doc/bitnet)[Blenderbot ](https://huggingface.co/docs/transformers/model_doc/blenderbot)[Blenderbot Small ](https://huggingface.co/docs/transformers/model_doc/blenderbot-small)[BLOOM ](https://huggingface.co/docs/transformers/model_doc/bloom)[BORT ](https://huggingface.co/docs/transformers/model_doc/bort)[ByT5 ](https://huggingface.co/docs/transformers/model_doc/byt5)[CamemBERT ](https://huggingface.co/docs/transformers/model_doc/camembert)[CANINE ](https://huggingface.co/docs/transformers/model_doc/canine)[CodeGen ](https://huggingface.co/docs/transformers/model_doc/codegen)[CodeLlama ](https://huggingface.co/docs/transformers/model_doc/code_llama)[Cohere ](https://huggingface.co/docs/transformers/model_doc/cohere)[Cohere2 ](https://huggingface.co/docs/transformers/model_doc/cohere2)[ConvBERT ](https://huggingface.co/docs/transformers/model_doc/convbert)[CPM ](https://huggingface.co/docs/transformers/model_doc/cpm)[CPMANT ](https://huggingface.co/docs/transformers/model_doc/cpmant)[CTRL ](https://huggingface.co/docs/transformers/model_doc/ctrl)[DBRX ](https://huggingface.co/docs/transformers/model_doc/dbrx)[DeBERTa ](https://huggingface.co/docs/transformers/model_doc/deberta)[DeBERTa-v2 ](https://huggingface.co/docs/transformers/model_doc/deberta-v2)[DeepSeek-V3 ](https://huggingface.co/docs/transformers/model_doc/deepseek_v3)[DialoGPT ](https://huggingface.co/docs/transformers/model_doc/dialogpt)[DiffLlama ](https://huggingface.co/docs/transformers/model_doc/diffllama)[DistilBERT ](https://huggingface.co/docs/transformers/model_doc/distilbert)[dots1 ](https://huggingface.co/docs/transformers/model_doc/dots1)[DPR ](https://huggingface.co/docs/transformers/model_doc/dpr)[ELECTRA ](https://huggingface.co/docs/transformers/model_doc/electra)[Encoder Decoder Models ](https://huggingface.co/docs/transformers/model_doc/encoder-decoder)[ERNIE ](https://huggingface.co/docs/transformers/model_doc/ernie)[ErnieM ](https://huggingface.co/docs/transformers/model_doc/ernie_m)[ESM ](https://huggingface.co/docs/transformers/model_doc/esm)[Falcon ](https://huggingface.co/docs/transformers/model_doc/falcon)[Falcon3 ](https://huggingface.co/docs/transformers/model_doc/falcon3)[FalconH1 ](https://huggingface.co/docs/transformers/model_doc/falcon_h1)[FalconMamba ](https://huggingface.co/docs/transformers/model_doc/falcon_mamba)[FLAN-T5 ](https://huggingface.co/docs/transformers/model_doc/flan-t5)[FLAN-UL2 ](https://huggingface.co/docs/transformers/model_doc/flan-ul2)[FlauBERT ](https://huggingface.co/docs/transformers/model_doc/flaubert)[FNet ](https://huggingface.co/docs/transformers/model_doc/fnet)[FSMT ](https://huggingface.co/docs/transformers/model_doc/fsmt)[Funnel Transformer ](https://huggingface.co/docs/transformers/model_doc/funnel)[Fuyu ](https://huggingface.co/docs/transformers/model_doc/fuyu)[Gemma ](https://huggingface.co/docs/transformers/model_doc/gemma)[Gemma2 ](https://huggingface.co/docs/transformers/model_doc/gemma2)[GLM ](https://huggingface.co/docs/transformers/model_doc/glm)[glm4 ](https://huggingface.co/docs/transformers/model_doc/glm4)[GPT ](https://huggingface.co/docs/transformers/model_doc/openai-gpt)[GPT Neo ](https://huggingface.co/docs/transformers/model_doc/gpt_neo)[GPT NeoX ](https://huggingface.co/docs/transformers/model_doc/gpt_neox)[GPT NeoX Japanese ](https://huggingface.co/docs/transformers/model_doc/gpt_neox_japanese)[GPT-J ](https://huggingface.co/docs/transformers/model_doc/gptj)[GPT2 ](https://huggingface.co/docs/transformers/model_doc/gpt2)[GPTBigCode ](https://huggingface.co/docs/transformers/model_doc/gpt_bigcode)[GPTSAN Japanese ](https://huggingface.co/docs/transformers/model_doc/gptsan-japanese)[GPTSw3 ](https://huggingface.co/docs/transformers/model_doc/gpt-sw3)[Granite ](https://huggingface.co/docs/transformers/model_doc/granite)[GraniteMoe ](https://huggingface.co/docs/transformers/model_doc/granitemoe)[GraniteMoeHybrid ](https://huggingface.co/docs/transformers/model_doc/granitemoehybrid)[GraniteMoeShared ](https://huggingface.co/docs/transformers/model_doc/granitemoeshared)[Helium ](https://huggingface.co/docs/transformers/model_doc/helium)[HerBERT ](https://huggingface.co/docs/transformers/model_doc/herbert)[HGNet-V2 ](https://huggingface.co/docs/transformers/model_doc/hgnet_v2)[I-BERT ](https://huggingface.co/docs/transformers/model_doc/ibert)[Jamba ](https://huggingface.co/docs/transformers/model_doc/jamba)[JetMoe ](https://huggingface.co/docs/transformers/model_doc/jetmoe)[Jukebox ](https://huggingface.co/docs/transformers/model_doc/jukebox)[LED ](https://huggingface.co/docs/transformers/model_doc/led)[LLaMA ](https://huggingface.co/docs/transformers/model_doc/llama)[Llama2 ](https://huggingface.co/docs/transformers/model_doc/llama2)[Llama3 ](https://huggingface.co/docs/transformers/model_doc/llama3)[Longformer ](https://huggingface.co/docs/transformers/model_doc/longformer)[LongT5 ](https://huggingface.co/docs/transformers/model_doc/longt5)[LUKE ](https://huggingface.co/docs/transformers/model_doc/luke)[M2M100 ](https://huggingface.co/docs/transformers/model_doc/m2m_100)[MADLAD-400 ](https://huggingface.co/docs/transformers/model_doc/madlad-400)[Mamba ](https://huggingface.co/docs/transformers/model_doc/mamba)[Mamba2 ](https://huggingface.co/docs/transformers/model_doc/mamba2)[MarianMT ](https://huggingface.co/docs/transformers/model_doc/marian)[MarkupLM ](https://huggingface.co/docs/transformers/model_doc/markuplm)[MBart and MBart-50 ](https://huggingface.co/docs/transformers/model_doc/mbart)[MEGA ](https://huggingface.co/docs/transformers/model_doc/mega)[MegatronBERT ](https://huggingface.co/docs/transformers/model_doc/megatron-bert)[MegatronGPT2 ](https://huggingface.co/docs/transformers/model_doc/megatron_gpt2)[MiniMax ](https://huggingface.co/docs/transformers/model_doc/minimax)[Mistral ](https://huggingface.co/docs/transformers/model_doc/mistral)[Mixtral ](https://huggingface.co/docs/transformers/model_doc/mixtral)[mLUKE ](https://huggingface.co/docs/transformers/model_doc/mluke)[MobileBERT ](https://huggingface.co/docs/transformers/model_doc/mobilebert)[ModernBert ](https://huggingface.co/docs/transformers/model_doc/modernbert)[MPNet ](https://huggingface.co/docs/transformers/model_doc/mpnet)[MPT ](https://huggingface.co/docs/transformers/model_doc/mpt)[MRA ](https://huggingface.co/docs/transformers/model_doc/mra)[MT5 ](https://huggingface.co/docs/transformers/model_doc/mt5)[MVP ](https://huggingface.co/docs/transformers/model_doc/mvp)[myt5 ](https://huggingface.co/docs/transformers/model_doc/myt5)[Nemotron ](https://huggingface.co/docs/transformers/model_doc/nemotron)[NEZHA ](https://huggingface.co/docs/transformers/model_doc/nezha)[NLLB ](https://huggingface.co/docs/transformers/model_doc/nllb)[NLLB-MoE ](https://huggingface.co/docs/transformers/model_doc/nllb-moe)[Nystr√∂mformer ](https://huggingface.co/docs/transformers/model_doc/nystromformer)[OLMo ](https://huggingface.co/docs/transformers/model_doc/olmo)[OLMo2 ](https://huggingface.co/docs/transformers/model_doc/olmo2)[OLMoE ](https://huggingface.co/docs/transformers/model_doc/olmoe)[Open-Llama ](https://huggingface.co/docs/transformers/model_doc/open-llama)[OPT ](https://huggingface.co/docs/transformers/model_doc/opt)[Pegasus ](https://huggingface.co/docs/transformers/model_doc/pegasus)[PEGASUS-X ](https://huggingface.co/docs/transformers/model_doc/pegasus_x)[Persimmon ](https://huggingface.co/docs/transformers/model_doc/persimmon)[Phi ](https://huggingface.co/docs/transformers/model_doc/phi)[Phi-3 ](https://huggingface.co/docs/transformers/model_doc/phi3)[PhiMoE ](https://huggingface.co/docs/transformers/model_doc/phimoe)[PhoBERT ](https://huggingface.co/docs/transformers/model_doc/phobert)[PLBart ](https://huggingface.co/docs/transformers/model_doc/plbart)[ProphetNet ](https://huggingface.co/docs/transformers/model_doc/prophetnet)[QDQBert ](https://huggingface.co/docs/transformers/model_doc/qdqbert)[Qwen2 ](https://huggingface.co/docs/transformers/model_doc/qwen2)[Qwen2MoE ](https://huggingface.co/docs/transformers/model_doc/qwen2_moe)[Qwen3 ](https://huggingface.co/docs/transformers/model_doc/qwen3)[Qwen3MoE ](https://huggingface.co/docs/transformers/model_doc/qwen3_moe)[RAG ](https://huggingface.co/docs/transformers/model_doc/rag)[REALM ](https://huggingface.co/docs/transformers/model_doc/realm)[RecurrentGemma ](https://huggingface.co/docs/transformers/model_doc/recurrent_gemma)[Reformer ](https://huggingface.co/docs/transformers/model_doc/reformer)[RemBERT ](https://huggingface.co/docs/transformers/model_doc/rembert)[RetriBERT ](https://huggingface.co/docs/transformers/model_doc/retribert)[RoBERTa ](https://huggingface.co/docs/transformers/model_doc/roberta)[RoBERTa-PreLayerNorm ](https://huggingface.co/docs/transformers/model_doc/roberta-prelayernorm)[RoCBert ](https://huggingface.co/docs/transformers/model_doc/roc_bert)[RoFormer ](https://huggingface.co/docs/transformers/model_doc/roformer)[RWKV ](https://huggingface.co/docs/transformers/model_doc/rwkv)[Splinter ](https://huggingface.co/docs/transformers/model_doc/splinter)[SqueezeBERT ](https://huggingface.co/docs/transformers/model_doc/squeezebert)[StableLm ](https://huggingface.co/docs/transformers/model_doc/stablelm)[Starcoder2 ](https://huggingface.co/docs/transformers/model_doc/starcoder2)[SwitchTransformers ](https://huggingface.co/docs/transformers/model_doc/switch_transformers)[T5 ](https://huggingface.co/docs/transformers/model_doc/t5)[T5Gemma ](https://huggingface.co/docs/transformers/model_doc/t5gemma)[T5v1.1 ](https://huggingface.co/docs/transformers/model_doc/t5v1.1)[TAPEX ](https://huggingface.co/docs/transformers/model_doc/tapex)[Transformer XL ](https://huggingface.co/docs/transformers/model_doc/transfo-xl)[UL2 ](https://huggingface.co/docs/transformers/model_doc/ul2)[UMT5 ](https://huggingface.co/docs/transformers/model_doc/umt5)[X-MOD ](https://huggingface.co/docs/transformers/model_doc/xmod)[XGLM ](https://huggingface.co/docs/transformers/model_doc/xglm)[XLM ](https://huggingface.co/docs/transformers/model_doc/xlm)[XLM-ProphetNet ](https://huggingface.co/docs/transformers/model_doc/xlm-prophetnet)[XLM-RoBERTa ](https://huggingface.co/docs/transformers/model_doc/xlm-roberta)[XLM-RoBERTa-XL ](https://huggingface.co/docs/transformers/model_doc/xlm-roberta-xl)[XLM-V ](https://huggingface.co/docs/transformers/model_doc/xlm-v)[XLNet ](https://huggingface.co/docs/transformers/model_doc/xlnet)[YOSO ](https://huggingface.co/docs/transformers/model_doc/yoso)[Zamba ](https://huggingface.co/docs/transformers/model_doc/zamba)[Zamba2 ](https://huggingface.co/docs/transformers/model_doc/zamba2)
Vision models
Audio models
Video models
Multimodal models
Reinforcement learning models
Time series models
Graph models
Internal helpers
Reference
![Hugging Face's logo](https://huggingface.co/front/assets/huggingface_logo-noborder.svg)
Join the Hugging Face community
and get access to the augmented documentation experience 
Collaborate on models, datasets and Spaces 
Faster examples with accelerated inference 
Switch between documentation themes 
[Sign Up](https://huggingface.co/join)
to get started
![PyTorch](https://img.shields.io/badge/PyTorch-DE3412?style=flat&logo=pytorch&logoColor=white) ![Flax](https://img.shields.io/badge/Flax-29a79b.svg?style=flat&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAMAAAANxBKoAAAC7lBMVEUAAADg5vYHPVgAoJH+/v76+v39/f9JbLP///9+AIgAnY3///+mcqzt8fXy9fgkXa3Ax9709fr+///9/f8qXq49qp5AaLGMwrv8/P0eW60VWawxYq8yqJzG2dytt9Wyu9elzci519Lf3O3S2efY3OrY0+Xp7PT///////+dqNCexMc6Z7AGpJeGvbenstPZ5ejQ1OfJzOLa7ejh4+/r8fT29vpccbklWK8PVa0AS6ghW63O498vYa+lsdKz1NDRt9Kw1c672tbD3tnAxt7R6OHp5vDe7OrDyuDn6vLl6/EAQKak0MgATakkppo3ZK/Bz9y8w9yzu9jey97axdvHzeG21NHH4trTwthKZrVGZLSUSpuPQJiGAI+GAI8SWKydycLL4d7f2OTi1+S9xNzL0ePT6OLGzeEAo5U0qJw/aLEAo5JFa7JBabEAp5Y4qZ2QxLyKmsm3kL2xoMOehrRNb7RIbbOZgrGre68AUqwAqZqNN5aKJ5N/lMq+qsd8kMa4pcWzh7muhLMEV69juq2kbKqgUaOTR5uMMZWLLZSGAI5VAIdEAH+ovNDHuNCnxcy3qcaYx8K8msGplrx+wLahjbYdXrV6vbMvYK9DrZ8QrZ8tqJuFms+Sos6sw8ecy8RffsNVeMCvmb43aLltv7Q4Y7EZWK4QWa1gt6meZKUdr6GOAZVeA4xPAISyveLUwtivxtKTpNJ2jcqfvcltiMiwwcfAoMVxhL+Kx7xjdrqTe60tsaNQs6KaRKACrJ6UTZwkqpqTL5pkHY4AloSgsd2ptNXPvNOOncuxxsqFl8lmg8apt8FJcr9EbryGxLqlkrkrY7dRa7ZGZLQ5t6iXUZ6PPpgVpZeJCJFKAIGareTa0+KJod3H0deY2M+esM25usmYu8d2zsJOdcBVvrCLbqcAOaaHaKQAMaScWqKBXqCXMJ2RHpiLF5NmJZAdAHN2kta11dKu1M+DkcZLdb+Mcql3TppyRJdzQ5ZtNZNlIY+DF4+voCOQAAAAZ3RSTlMABAT+MEEJ/RH+/TP+Zlv+pUo6Ifz8+fco/fz6+evr39S9nJmOilQaF/7+/f38+smmoYp6b1T+/v7++vj189zU0tDJxsGzsrKSfv34+Pf27dDOysG9t6+n/vv6+vr59uzr1tG+tZ6Qg9Ym3QAABR5JREFUSMeNlVVUG1EQhpcuxEspXqS0SKEtxQp1d3d332STTRpIQhIISQgJhODu7lAoDoUCpe7u7u7+1puGpqnCPOyZvffbOXPm/PsP9JfQgyCC+tmTABTOcbxDz/heENS7/1F+9nhvkHePG0wNDLbGWwdXL+rbLWvpmZHXD8+gMfBjTh+aSe6Gnn7lwQIOTR0c8wfX3PWgv7avbdKwf/ZoBp1Gp/PvuvXW3vw5ib7emnTW4OR+3D4jB9vjNJ/7gNvfWWeH/TO/JyYrsiKCRjVEZA3UB+96kON+DxOQ/NLE8PE5iUYgIXjFnCOlxEQMaSGVxjg4gxOnEycGz8bptuNjVx08LscIgrzH3umcn+KKtiBIyvzOO2O99aAdR8cF19oZalnCtvREUw79tCd5sow1g1UKM6kXqUx4T8wsi3sTjJ3yzDmmhenLXLpo8u45eG5y4Vvbk6kkC4LLtJMowkSQxmk4ggVJEG+7c6QpHT8vvW9X7/o7+3ELmiJi2mEzZJiz8cT6TBlanBk70cB5GGIGC1gRDdZ00yADLW1FL6gqhtvNXNG5S9gdSrk4M1qu7JAsmYshzDS4peoMrU/gT7qQdqYGZaYhxZmVbGJAm/CS/HloWyhRUlknQ9KYcExTwS80d3VNOxUZJpITYyspl0LbhArhpZCD9cRWEQuhYkNGMHToQ/2Cs6swJlb39CsllxdXX6IUKh/H5jbnSsPKjgmoaFQ1f8wRLR0UnGE/RcDEjj2jXG1WVTwUs8+zxfcrVO+vSsuOpVKxCfYZiQ0/aPKuxQbQ8lIz+DClxC8u+snlcJ7Yr1z1JPqUH0V+GDXbOwAib931Y4Imaq0NTIXPXY+N5L18GJ37SVWu+hwXff8l72Ds9XuwYIBaXPq6Shm4l+Vl/5QiOlV+uTk6YR9PxKsI9xNJny31ygK1e+nIRC1N97EGkFPI+jCpiHe5PCEy7oWqWSwRrpOvhFzcbTWMbm3ZJAOn1rUKpYIt/lDhW/5RHHteeWFN60qo98YJuoq1nK3uW5AabyspC1BcIEpOhft+SZAShYoLSvnmSfnYADUERP5jJn2h5XtsgCRuhYQqAvwTwn33+YWEKUI72HX5AtfSAZDe8F2DtPPm77afhl0EkthzuCQU0BWApgQIH9+KB0JhopMM7bJrdTRoleM2JAVNMyPF+wdoaz+XJpGoVAQ7WXUkcV7gT3oUZyi/ISIJAVKhgNp+4b4veCFhYVJw4locdSjZCp9cPUhLF9EZ3KKzURepMEtCDPP3VcWFx4UIiZIklIpFNfHpdEafIF2aRmOcrUmjohbT2WUllbmRvgfbythbQO3222fpDJoufaQPncYYuqoGtUEsCJZL6/3PR5b4syeSjZMQG/T2maGANlXT2v8S4AULWaUkCxfLyW8iW4kdka+nEMjxpL2NCwsYNBp+Q61PF43zyDg9Bm9+3NNySn78jMZUUkumqE4Gp7JmFOdP1vc8PpRrzj9+wPinCy8K1PiJ4aYbnTYpCCbDkBSbzhu2QJ1Gd82t8jI8TH51+OzvXoWbnXUOBkNW+0mWFwGcGOUVpU81/n3TOHb5oMt2FgYGjzau0Nif0Ss7Q3XB33hjjQHjHA5E5aOyIQc8CBrLdQSs3j92VG+3nNEjbkbdbBr9zm04ruvw37vh0QKOdeGIkckc80fX3KH/h7PT4BOjgCty8VZ5ux1MoO5Cf5naca2LAsEgehI+drX8o/0Nu+W0m6K/I9gGPd/dfx/EN/wN62AhsBWuAAAAAElFTkSuQmCC    )
# [](https://huggingface.co/docs/transformers/model_doc/llama2#llama-2) Llama 2
[Llama 2](https://huggingface.co/papers/2307.09288) is a family of large language models, Llama 2 and Llama 2-Chat, available in 7B, 13B, and 70B parameters. The Llama 2 model mostly keeps the same architecture as [Llama](https://huggingface.co/docs/transformers/model_doc/llama), but it is pretrained on more tokens, doubles the context length, and uses grouped-query attention (GQA) in the 70B model to improve inference.
Llama 2-Chat is trained with supervised fine-tuning (SFT), and reinforcement learning with human feedback (RLHF) - rejection sampling and proximal policy optimization (PPO) - is applied to the fine-tuned model to align the chat model with human preferences.
You can find all the original Llama 2 checkpoints under the [Llama 2 Family](https://huggingface.co/collections/meta-llama/llama-2-family-661da1f90a9d678b6f55773b) collection.
Click on the Llama 2 models in the right sidebar for more examples of how to apply Llama to different language tasks.
The example below demonstrates how to generate text with [Pipeline](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/pipelines#transformers.Pipeline), [AutoModel](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/auto#transformers.AutoModel), and how to chat with Llama 2-Chat from the command line.
Pipeline 
AutoModel 
transformers CLI 
Copied
```
import torch
from transformers import pipeline
pipeline = pipeline(
  task="text-generation",
  model="meta-llama/Llama-2-7b-hf",
  torch_dtype=torch.float16,
  device=0
)
pipeline("Plants create energy through a process known as")
```

Quantization reduces the memory burden of large models by representing the weights in a lower precision. Refer to the [Quantization](https://huggingface.co/docs/transformers/quantization/overview) overview for more available quantization backends.
The example below uses [torchao](https://huggingface.co/docs/transformers/quantization/torchao) to only quantize the weights to int4.
Copied
```
# pip install torchao
import torch
from transformers import TorchAoConfig, AutoModelForCausalLM, AutoTokenizer
quantization_config = TorchAoConfig("int4_weight_only", group_size=128)
model = AutoModelForCausalLM.from_pretrained(
  "meta-llama/Llama-2-13b-hf",
  torch_dtype=torch.bfloat16,
  device_map="auto",
  quantization_config=quantization_config
)
tokenizer = AutoTokenizer.from_pretrained("meta-llama/Llama-2-13b-hf")
input_ids = tokenizer("Plants create energy through a process known as", return_tensors="pt").to("cuda")
output = model.generate(**input_ids, cache_implementation="static")
print(tokenizer.decode(output[0], skip_special_tokens=True))
```

Use the [AttentionMaskVisualizer](https://github.com/huggingface/transformers/blob/beb9b5b02246b9b7ee81ddf938f93f44cfeaad19/src/transformers/utils/attention_visualizer.py#L139) to better understand what tokens the model can and cannot attend to.
Copied
```
from transformers.utils.attention_visualizer import AttentionMaskVisualizer
visualizer = AttentionMaskVisualizer("meta-llama/Llama-2-7b-hf")
visualizer("Plants create energy through a process known as")
```

![](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/model_doc/llama-2-attn-mask.png)
## [](https://huggingface.co/docs/transformers/model_doc/llama2#notes) Notes
  * Setting `config.pretraining_tp` to a value besides `1` activates a more accurate but slower computation of the linear layers. This matches the original logits better.
  * The original model uses `pad_id = -1` to indicate a padding token. The Transformers implementation requires adding a padding token and resizing the token embedding accordingly.
Copied
```
tokenizer.add_special_tokens({"pad_token":"<pad>"})
# update model config with padding token
model.config.pad_token_id
```

  * It is recommended to initialize the `embed_tokens` layer with the following code to ensure encoding the padding token outputs zeros.
Copied
```
self.embed_tokens = nn.Embedding(config.vocab_size, config.hidden_size, self.config.padding_idx)
```

  * The tokenizer is a byte-pair encoding model based on [SentencePiece](https://github.com/google/sentencepiece). During decoding, if the first token is the start of the word (for example, ‚ÄúBanana‚Äù), the tokenizer doesn‚Äôt prepend the prefix space to the string.
  * Don‚Äôt use the `torch_dtype` parameter in [from_pretrained()](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/auto#transformers.AutoModel.from_pretrained) if you‚Äôre using FlashAttention-2 because it only supports fp16 or bf16. You should use [Automatic Mixed Precision](https://pytorch.org/tutorials/recipes/recipes/amp_recipe.html), set fp16 or bf16 to `True` if using [Trainer](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/trainer#transformers.Trainer), or use [torch.autocast](https://pytorch.org/docs/stable/amp.html#torch.autocast).


## [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig) LlamaConfig
### class transformers.LlamaConfig
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/configuration_llama.py#L26)
( vocab_size = 32000hidden_size = 4096intermediate_size = 11008num_hidden_layers = 32num_attention_heads = 32num_key_value_heads = Nonehidden_act = 'silu'max_position_embeddings = 2048initializer_range = 0.02rms_norm_eps = 1e-06use_cache = Truepad_token_id = Nonebos_token_id = 1eos_token_id = 2pretraining_tp = 1tie_word_embeddings = Falserope_theta = 10000.0rope_scaling = Noneattention_bias = Falseattention_dropout = 0.0mlp_bias = Falsehead_dim = None**kwargs )
Expand 22 parameters
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.vocab_size) **vocab_size** (`int`, _optional_ , defaults to 32000) ‚Äî Vocabulary size of the LLaMA model. Defines the number of different tokens that can be represented by the `inputs_ids` passed when calling [LlamaModel](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaModel)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.hidden_size) **hidden_size** (`int`, _optional_ , defaults to 4096) ‚Äî Dimension of the hidden representations.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.intermediate_size) **intermediate_size** (`int`, _optional_ , defaults to 11008) ‚Äî Dimension of the MLP representations.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.num_hidden_layers) **num_hidden_layers** (`int`, _optional_ , defaults to 32) ‚Äî Number of hidden layers in the Transformer decoder.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.num_attention_heads) **num_attention_heads** (`int`, _optional_ , defaults to 32) ‚Äî Number of attention heads for each attention layer in the Transformer decoder.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.num_key_value_heads) **num_key_value_heads** (`int`, _optional_) ‚Äî This is the number of key_value heads that should be used to implement Grouped Query Attention. If `num_key_value_heads=num_attention_heads`, the model will use Multi Head Attention (MHA), if `num_key_value_heads=1` the model will use Multi Query Attention (MQA) otherwise GQA is used. When converting a multi-head checkpoint to a GQA checkpoint, each group key and value head should be constructed by meanpooling all the original heads within that group. For more details, check out [this paper](https://huggingface.co/papers/2305.13245). If it is not specified, will default to `num_attention_heads`.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.hidden_act) **hidden_act** (`str` or `function`, _optional_ , defaults to `"silu"`) ‚Äî The non-linear activation function (function or string) in the decoder.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.max_position_embeddings) **max_position_embeddings** (`int`, _optional_ , defaults to 2048) ‚Äî The maximum sequence length that this model might ever be used with. Llama 1 supports up to 2048 tokens, Llama 2 up to 4096, CodeLlama up to 16384.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.initializer_range) **initializer_range** (`float`, _optional_ , defaults to 0.02) ‚Äî The standard deviation of the truncated_normal_initializer for initializing all weight matrices.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.rms_norm_eps) **rms_norm_eps** (`float`, _optional_ , defaults to 1e-06) ‚Äî The epsilon used by the rms normalization layers.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.use_cache) **use_cache** (`bool`, _optional_ , defaults to `True`) ‚Äî Whether or not the model should return the last key/values attentions (not used by all models). Only relevant if `config.is_decoder=True`.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.pad_token_id) **pad_token_id** (`int`, _optional_) ‚Äî Padding token id.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.bos_token_id) **bos_token_id** (`int`, _optional_ , defaults to 1) ‚Äî Beginning of stream token id.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.eos_token_id) **eos_token_id** (`int`, _optional_ , defaults to 2) ‚Äî End of stream token id.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.pretraining_tp) **pretraining_tp** (`int`, _optional_ , defaults to 1) ‚Äî Experimental feature. Tensor parallelism rank used during pretraining. Please refer to [this document](https://huggingface.co/docs/transformers/main/perf_train_gpu_many#tensor-parallelism) to understand more about it. This value is necessary to ensure exact reproducibility of the pretraining results. Please refer to [this issue](https://github.com/pytorch/pytorch/issues/76232).
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.tie_word_embeddings) **tie_word_embeddings** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether to tie weight embeddings
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.rope_theta) **rope_theta** (`float`, _optional_ , defaults to 10000.0) ‚Äî The base period of the RoPE embeddings.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.rope_scaling) **rope_scaling** (`Dict`, _optional_) ‚Äî Dictionary containing the scaling configuration for the RoPE embeddings. NOTE: if you apply new rope type and you expect the model to work on longer `max_position_embeddings`, we recommend you to update this value accordingly. Expected contents: `rope_type` (`str`): The sub-variant of RoPE to use. Can be one of [‚Äòdefault‚Äô, ‚Äòlinear‚Äô, ‚Äòdynamic‚Äô, ‚Äòyarn‚Äô, ‚Äòlongrope‚Äô, ‚Äòllama3‚Äô], with ‚Äòdefault‚Äô being the original RoPE implementation. `factor` (`float`, _optional_): Used with all rope types except ‚Äòdefault‚Äô. The scaling factor to apply to the RoPE embeddings. In most scaling types, a `factor` of x will enable the model to handle sequences of length x _original maximum pre-trained length.`original_max_position_embeddings` (`int`, _optional _): Used with ‚Äòdynamic‚Äô, ‚Äòlongrope‚Äô and ‚Äòllama3‚Äô. The original max position embeddings used during pretraining.`attention_factor` (`float`, _optional _): Used with ‚Äòyarn‚Äô and ‚Äòlongrope‚Äô. The scaling factor to be applied on the attention computation. If unspecified, it defaults to value recommended by the implementation, using the`factor` field to infer the suggested value. `beta_fast` (`float`, _optional _): Only used with ‚Äòyarn‚Äô. Parameter to set the boundary for extrapolation (only) in the linear ramp function. If unspecified, it defaults to 32.`beta_slow` (`float`, _optional _): Only used with ‚Äòyarn‚Äô. Parameter to set the boundary for interpolation (only) in the linear ramp function. If unspecified, it defaults to 1.`short_factor` (`list[float]`, _optional _): Only used with ‚Äòlongrope‚Äô. The scaling factor to be applied to short contexts ( < `original_max_position_embeddings`). Must be a list of numbers with the same length as the hidden size divided by the number of attention heads divided by 2 `long_factor` (`list[float]`, _optional _): Only used with ‚Äòlongrope‚Äô. The scaling factor to be applied to long contexts ( < `original_max_position_embeddings`). Must be a list of numbers with the same length as the hidden size divided by the number of attention heads divided by 2 `low_freq_factor` (`float`, _optional _): Only used with ‚Äòllama3‚Äô. Scaling factor applied to low frequency components of the RoPE`high_freq_factor` (`float`, _optional*): Only used with ‚Äòllama3‚Äô. Scaling factor applied to high frequency components of the RoPE
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.attention_bias) **attention_bias** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether to use a bias in the query, key, value and output projection layers during self-attention.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.attention_dropout) **attention_dropout** (`float`, _optional_ , defaults to 0.0) ‚Äî The dropout ratio for the attention probabilities.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.mlp_bias) **mlp_bias** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether to use a bias in up_proj, down_proj and gate_proj layers in the MLP layers.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.head_dim) **head_dim** (`int`, _optional_) ‚Äî The attention head dimension. If None, it will default to hidden_size // num_attention_heads


This is the configuration class to store the configuration of a [LlamaModel](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaModel). It is used to instantiate an LLaMA model according to the specified arguments, defining the model architecture. Instantiating a configuration with the defaults will yield a similar configuration to that of the LLaMA-7B. e.g. [meta-llama/Llama-2-7b-hf](https://huggingface.co/meta-llama/Llama-2-7b-hf)
Configuration objects inherit from [PretrainedConfig](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/configuration#transformers.PretrainedConfig) and can be used to control the model outputs. Read the documentation from [PretrainedConfig](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/configuration#transformers.PretrainedConfig) for more information.
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig.example)
Copied
```
>>> from transformers import LlamaModel, LlamaConfig
>>> # Initializing a LLaMA llama-7b style configuration
>>> configuration = LlamaConfig()
>>> # Initializing a model from the llama-7b style configuration
>>> model = LlamaModel(configuration)
>>> # Accessing the model configuration
>>> configuration = model.config
```

## [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer) LlamaTokenizer
### class transformers.LlamaTokenizer
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama.py#L55)
( vocab_fileunk_token = '<unk>'bos_token = '<s>'eos_token = '</s>'pad_token = Nonesp_model_kwargs: typing.Optional[dict[str, typing.Any]] = Noneadd_bos_token = Trueadd_eos_token = Falseclean_up_tokenization_spaces = Falseuse_default_system_prompt = Falsespaces_between_special_tokens = Falselegacy = Noneadd_prefix_space = True**kwargs )
Expand 12 parameters
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.vocab_file) **vocab_file** (`str`) ‚Äî Path to the vocabulary file.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.unk_token) **unk_token** (`str` or `tokenizers.AddedToken`, _optional_ , defaults to `"<unk>"`) ‚Äî The unknown token. A token that is not in the vocabulary cannot be converted to an ID and is set to be this token instead.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.bos_token) **bos_token** (`str` or `tokenizers.AddedToken`, _optional_ , defaults to `"<s>"`) ‚Äî The beginning of sequence token that was used during pretraining. Can be used a sequence classifier token.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.eos_token) **eos_token** (`str` or `tokenizers.AddedToken`, _optional_ , defaults to `"</s>"`) ‚Äî The end of sequence token.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.pad_token) **pad_token** (`str` or `tokenizers.AddedToken`, _optional_) ‚Äî A special token used to make arrays of tokens the same size for batching purpose. Will then be ignored by attention mechanisms or loss computation.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.sp_model_kwargs) **sp_model_kwargs** (`dict[str, Any]`, `Optional`, _optional_) ‚Äî Will be passed to the `SentencePieceProcessor.__init__()` method. The [Python wrapper for SentencePiece](https://github.com/google/sentencepiece/tree/master/python) can be used, among other things, to set: 
    * `enable_sampling`: Enable subword regularization.
    * `nbest_size`: Sampling parameters for unigram. Invalid for BPE-Dropout.
      * `nbest_size = {0,1}`: No sampling is performed.
      * `nbest_size > 1`: samples from the nbest_size results.
      * `nbest_size < 0`: assuming that nbest_size is infinite and samples from the all hypothesis (lattice) using forward-filtering-and-backward-sampling algorithm.
    * `alpha`: Smoothing parameter for unigram sampling, and dropout probability of merge operations for BPE-dropout.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.add_bos_token) **add_bos_token** (`bool`, _optional_ , defaults to `True`) ‚Äî Whether or not to add an `bos_token` at the start of sequences.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.add_eos_token) **add_eos_token** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not to add an `eos_token` at the end of sequences.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.clean_up_tokenization_spaces) **clean_up_tokenization_spaces** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not to cleanup spaces after decoding, cleanup consists in removing potential artifacts like extra spaces.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.use_default_system_prompt) **use_default_system_prompt** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not the default system prompt for Llama should be used.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.spaces_between_special_tokens) **spaces_between_special_tokens** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not to add spaces between special tokens.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.legacy) **legacy** (`bool`, _optional_) ‚Äî Whether or not the `legacy` behavior of the tokenizer should be used. Legacy is before the merge of #24622 and #25224 which includes fixes to properly handle tokens that appear after special tokens. Make sure to also set `from_slow` to `True`. A simple example: 
    * `legacy=True`:


Construct a Llama tokenizer. Based on byte-level Byte-Pair-Encoding. The default padding token is unset as there is no padding token in the original model.
#### build_inputs_with_special_tokens
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.build_inputs_with_special_tokens) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama.py#L333)
( token_ids_0token_ids_1 = None )
#### get_special_tokens_mask
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.get_special_tokens_mask) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama.py#L344)
( token_ids_0: listtoken_ids_1: typing.Optional[list[int]] = Nonealready_has_special_tokens: bool = False ) ‚Üí `list[int]`
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.get_special_tokens_mask.token_ids_0) **token_ids_0** (`list[int]`) ‚Äî List of IDs.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.get_special_tokens_mask.token_ids_1) **token_ids_1** (`list[int]`, _optional_) ‚Äî Optional second list of IDs for sequence pairs.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.get_special_tokens_mask.already_has_special_tokens) **already_has_special_tokens** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not the token list is already formatted with special tokens for the model.


Returns
`list[int]`
A list of integers in the range [0, 1]: 1 for a special token, 0 for a sequence token.
Retrieve sequence ids from a token list that has no special tokens added. This method is called when adding special tokens using the tokenizer `prepare_for_model` method.
#### create_token_type_ids_from_sequences
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.create_token_type_ids_from_sequences) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama.py#L381)
( token_ids_0: listtoken_ids_1: typing.Optional[list[int]] = None ) ‚Üí `list[int]`
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.create_token_type_ids_from_sequences.token_ids_0) **token_ids_0** (`list[int]`) ‚Äî List of ids.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.create_token_type_ids_from_sequences.token_ids_1) **token_ids_1** (`list[int]`, _optional_) ‚Äî Optional second list of IDs for sequence pairs.


Returns
`list[int]`
List of [token type IDs](https://huggingface.co/docs/transformers/glossary#token-type-ids) according to the given sequence(s).
Creates a mask from the two sequences passed to be used in a sequence-pair classification task. An ALBERT
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.create_token_type_ids_from_sequences.example)
sequence pair mask has the following format:
Copied
```
0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1
| first sequence  | second sequence |
```

if token_ids_1 is None, only returns the first portion of the mask (0s).
#### save_vocabulary
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.save_vocabulary) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama.py#L306)
( save_directoryfilename_prefix: typing.Optional[str] = None ) ‚Üí `Tuple(str)`
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer.save_vocabulary.save_directory) **save_directory** (`str`) ‚Äî The directory in which to save the vocabulary.


Returns
`Tuple(str)`
Paths to the files saved.
Save the vocabulary and special tokens file to a directory.
## [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast) LlamaTokenizerFast
### class transformers.LlamaTokenizerFast
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama_fast.py#L46)
( vocab_file = Nonetokenizer_file = Noneclean_up_tokenization_spaces = Falseunk_token = '<unk>'bos_token = '<s>'eos_token = '</s>'add_bos_token = Trueadd_eos_token = Falseuse_default_system_prompt = Falselegacy = Noneadd_prefix_space = None**kwargs )
Expand 10 parameters
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.vocab_file) **vocab_file** (`str`, _optional_) ‚Äî [SentencePiece](https://github.com/google/sentencepiece) file (generally has a .model extension) that contains the vocabulary necessary to instantiate a tokenizer.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.tokenizer_file) **tokenizer_file** (`str`, _optional_) ‚Äî [tokenizers](https://github.com/huggingface/tokenizers) file (generally has a .json extension) that contains everything needed to load the tokenizer.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.clean_up_tokenization_spaces) **clean_up_tokenization_spaces** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not to cleanup spaces after decoding, cleanup consists in removing potential artifacts like extra spaces.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.unk_token) **unk_token** (`str` or `tokenizers.AddedToken`, _optional_ , defaults to `"<unk>"`) ‚Äî The unknown token. A token that is not in the vocabulary cannot be converted to an ID and is set to be this token instead.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.bos_token) **bos_token** (`str` or `tokenizers.AddedToken`, _optional_ , defaults to `"<s>"`) ‚Äî The beginning of sequence token that was used during pretraining. Can be used a sequence classifier token.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.eos_token) **eos_token** (`str` or `tokenizers.AddedToken`, _optional_ , defaults to `"</s>"`) ‚Äî The end of sequence token.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.add_bos_token) **add_bos_token** (`bool`, _optional_ , defaults to `True`) ‚Äî Whether or not to add an `bos_token` at the start of sequences.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.add_eos_token) **add_eos_token** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not to add an `eos_token` at the end of sequences.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.use_default_system_prompt) **use_default_system_prompt** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not the default system prompt for Llama should be used
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.legacy) **legacy** (`bool`, _optional_) ‚Äî Whether or not the `legacy` behavior of the tokenizer should be used. Legacy is before the merge of #24622 and #25224 which includes fixes to properly handle tokens that appear after special tokens. Make sure to also set `from_slow` to `True`. A simple example: 
    * `legacy=True`:


Construct a Llama tokenizer. Based on byte-level Byte-Pair-Encoding.
This uses notably ByteFallback and no normalization.
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.example)
Copied
```
>>> from transformers import LlamaTokenizerFast
>>> tokenizer = LlamaTokenizerFast.from_pretrained("hf-internal-testing/llama-tokenizer")
>>> tokenizer.encode("Hello this is a test")
[1, 15043, 445, 338, 263, 1243]
```

If you want to change the `bos_token` or the `eos_token`, make sure to specify them when initializing the model, or call `tokenizer.update_post_processor()` to make sure that the post-processing is correctly done (otherwise the values of the first token and final token of an encoded sequence will not be correct). For more details, checkout [post-processors] (<https://huggingface.co/docs/tokenizers/api/post-processors>) documentation.
This tokenizer inherits from [PreTrainedTokenizerFast](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/tokenizer#transformers.PreTrainedTokenizerFast) which contains most of the main methods. Users should refer to this superclass for more information regarding those methods.
#### build_inputs_with_special_tokens
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.build_inputs_with_special_tokens) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama_fast.py#L239)
( token_ids_0token_ids_1 = None )
#### get_special_tokens_mask
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.get_special_tokens_mask) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/tokenization_utils_base.py#L3857)
( token_ids_0: listtoken_ids_1: typing.Optional[list[int]] = Nonealready_has_special_tokens: bool = False ) ‚Üí A list of integers in the range [0, 1]
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.get_special_tokens_mask.token_ids_0) **token_ids_0** (`list[int]`) ‚Äî List of ids of the first sequence.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.get_special_tokens_mask.token_ids_1) **token_ids_1** (`list[int]`, _optional_) ‚Äî List of ids of the second sequence.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.get_special_tokens_mask.already_has_special_tokens) **already_has_special_tokens** (`bool`, _optional_ , defaults to `False`) ‚Äî Whether or not the token list is already formatted with special tokens for the model.


Returns
A list of integers in the range [0, 1]
1 for a special token, 0 for a sequence token.
Retrieves sequence ids from a token list that has no special tokens added. This method is called when adding special tokens using the tokenizer `prepare_for_model` or `encode_plus` methods.
#### create_token_type_ids_from_sequences
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.create_token_type_ids_from_sequences) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/tokenization_utils_base.py#L3376)
( token_ids_0: listtoken_ids_1: typing.Optional[list[int]] = None ) ‚Üí `list[int]`
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.create_token_type_ids_from_sequences.token_ids_0) **token_ids_0** (`list[int]`) ‚Äî The first tokenized sequence.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.create_token_type_ids_from_sequences.token_ids_1) **token_ids_1** (`list[int]`, _optional_) ‚Äî The second tokenized sequence.


Returns
`list[int]`
The token type ids.
Create the token type IDs corresponding to the sequences passed. [What are token type IDs?](https://huggingface.co/docs/transformers/glossary#token-type-ids)
Should be overridden in a subclass if the model has a special way of building those.
#### update_post_processor
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.update_post_processor) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama_fast.py#L174)
( )
Updates the underlying post processor with the current `bos_token` and `eos_token`.
#### save_vocabulary
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast.save_vocabulary) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/tokenization_llama_fast.py#L218)
( save_directory: strfilename_prefix: typing.Optional[str] = None )
## [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel) LlamaModel
### class transformers.LlamaModel
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/modeling_llama.py#L346)
( config: LlamaConfig )
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.config) **config** ([LlamaConfig](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaConfig)) ‚Äî Model configuration class with all the parameters of the model. Initializing with a config file does not load the weights associated with the model, only the configuration. Check out the [from_pretrained()](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/model#transformers.PreTrainedModel.from_pretrained) method to load the model weights.


The bare Llama Model outputting raw hidden-states without any specific head on top.
This model inherits from [PreTrainedModel](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/model#transformers.PreTrainedModel). Check the superclass documentation for the generic methods the library implements for all its model (such as downloading or saving, resizing the input embeddings, pruning heads etc.)
This model is also a PyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module) subclass. Use it as a regular PyTorch Module and refer to the PyTorch documentation for all matter related to general usage and behavior.
#### forward
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/modeling_llama.py#L370)
( input_ids: typing.Optional[torch.LongTensor] = Noneattention_mask: typing.Optional[torch.Tensor] = Noneposition_ids: typing.Optional[torch.LongTensor] = Nonepast_key_values: typing.Optional[transformers.cache_utils.Cache] = Noneinputs_embeds: typing.Optional[torch.FloatTensor] = Noneuse_cache: typing.Optional[bool] = Noneoutput_attentions: typing.Optional[bool] = Noneoutput_hidden_states: typing.Optional[bool] = Nonecache_position: typing.Optional[torch.LongTensor] = None**flash_attn_kwargs: typing_extensions.Unpack[transformers.modeling_flash_attention_utils.FlashAttentionKwargs] ) ‚Üí [transformers.modeling_outputs.BaseModelOutputWithPast](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/output#transformers.modeling_outputs.BaseModelOutputWithPast) or `tuple(torch.FloatTensor)`
Expand 9 parameters
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.input_ids) **input_ids** (`torch.LongTensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Indices of input sequence tokens in the vocabulary. Padding will be ignored by default. 
Indices can be obtained using [AutoTokenizer](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/auto#transformers.AutoTokenizer). See [PreTrainedTokenizer.encode()](https://huggingface.co/docs/transformers/v4.53.3/en/internal/tokenization_utils#transformers.PreTrainedTokenizerBase.encode) and [PreTrainedTokenizer.**call**()](https://huggingface.co/docs/transformers/v4.53.3/en/internal/tokenization_utils#transformers.PreTrainedTokenizerBase.__call__) for details.
[What are input IDs?](https://huggingface.co/docs/transformers/glossary#input-ids)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.attention_mask) **attention_mask** (`torch.Tensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Mask to avoid performing attention on padding token indices. Mask values selected in `[0, 1]`: 
    * 1 for tokens that are **not masked** ,
    * 0 for tokens that are **masked**.
[What are attention masks?](https://huggingface.co/docs/transformers/glossary#attention-mask)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.position_ids) **position_ids** (`torch.LongTensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Indices of positions of each input sequence tokens in the position embeddings. Selected in the range `[0, config.n_positions - 1]`. 
[What are position IDs?](https://huggingface.co/docs/transformers/glossary#position-ids)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.past_key_values) **past_key_values** (`~cache_utils.Cache`, _optional_) ‚Äî Pre-computed hidden-states (key and values in the self-attention blocks and in the cross-attention blocks) that can be used to speed up sequential decoding. This typically consists in the `past_key_values` returned by the model at a previous stage of decoding, when `use_cache=True` or `config.use_cache=True`. 
Two formats are allowed:
    * a [Cache](https://huggingface.co/docs/transformers/v4.53.3/en/internal/generation_utils#transformers.Cache) instance, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache);
    * Tuple of `tuple(torch.FloatTensor)` of length `config.n_layers`, with each tuple having 2 tensors of shape `(batch_size, num_heads, sequence_length, embed_size_per_head)`). This is also known as the legacy cache format.
The model will output the same cache format that is fed as input. If no `past_key_values` are passed, the legacy cache format will be returned.
If `past_key_values` are used, the user can optionally input only the last `input_ids` (those that don‚Äôt have their past key value states given to this model) of shape `(batch_size, 1)` instead of all `input_ids` of shape `(batch_size, sequence_length)`.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.inputs_embeds) **inputs_embeds** (`torch.FloatTensor` of shape `(batch_size, sequence_length, hidden_size)`, _optional_) ‚Äî Optionally, instead of passing `input_ids` you can choose to directly pass an embedded representation. This is useful if you want more control over how to convert `input_ids` indices into associated vectors than the model‚Äôs internal embedding lookup matrix.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.use_cache) **use_cache** (`bool`, _optional_) ‚Äî If set to `True`, `past_key_values` key value states are returned and can be used to speed up decoding (see `past_key_values`).
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.output_attentions) **output_attentions** (`bool`, _optional_) ‚Äî Whether or not to return the attentions tensors of all attention layers. See `attentions` under returned tensors for more detail.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.output_hidden_states) **output_hidden_states** (`bool`, _optional_) ‚Äî Whether or not to return the hidden states of all layers. See `hidden_states` under returned tensors for more detail.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel.forward.cache_position) **cache_position** (`torch.LongTensor` of shape `(sequence_length)`, _optional_) ‚Äî Indices depicting the position of the input sequence tokens in the sequence. Contrarily to `position_ids`, this tensor is not affected by padding. It is used to update the cache in the correct position and to infer the complete sequence length.


Returns
[transformers.modeling_outputs.BaseModelOutputWithPast](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/output#transformers.modeling_outputs.BaseModelOutputWithPast) or `tuple(torch.FloatTensor)`
A [transformers.modeling_outputs.BaseModelOutputWithPast](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/output#transformers.modeling_outputs.BaseModelOutputWithPast) or a tuple of `torch.FloatTensor` (if `return_dict=False` is passed or when `config.return_dict=False`) comprising various elements depending on the configuration ([LlamaConfig](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaConfig)) and inputs.
  * **last_hidden_state** (`torch.FloatTensor` of shape `(batch_size, sequence_length, hidden_size)`) ‚Äî Sequence of hidden-states at the output of the last layer of the model.
If `past_key_values` is used only the last hidden-state of the sequences of shape `(batch_size, 1, hidden_size)` is output.
  * **past_key_values** (`Cache`, _optional_ , returned when `use_cache=True` is passed or when `config.use_cache=True`) ‚Äî It is a [Cache](https://huggingface.co/docs/transformers/v4.53.3/en/internal/generation_utils#transformers.Cache) instance. For more details, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache).
Contains pre-computed hidden-states (key and values in the self-attention blocks and optionally if `config.is_encoder_decoder=True` in the cross-attention blocks) that can be used (see `past_key_values` input) to speed up sequential decoding.
  * **hidden_states** (`tuple(torch.FloatTensor)`, _optional_ , returned when `output_hidden_states=True` is passed or when `config.output_hidden_states=True`) ‚Äî Tuple of `torch.FloatTensor` (one for the output of the embeddings, if the model has an embedding layer, + one for the output of each layer) of shape `(batch_size, sequence_length, hidden_size)`.
Hidden-states of the model at the output of each layer plus the optional initial embedding outputs.
  * **attentions** (`tuple(torch.FloatTensor)`, _optional_ , returned when `output_attentions=True` is passed or when `config.output_attentions=True`) ‚Äî Tuple of `torch.FloatTensor` (one for each layer) of shape `(batch_size, num_heads, sequence_length, sequence_length)`.
Attentions weights after the attention softmax, used to compute the weighted average in the self-attention heads.


The [LlamaModel](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaModel) forward method, overrides the `__call__` special method.
Although the recipe for forward pass needs to be defined within this function, one should call the `Module` instance afterwards instead of this since the former takes care of running the pre and post processing steps while the latter silently ignores them.
## [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM) LlamaForCausalLM
### class transformers.LlamaForCausalLM
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/modeling_llama.py#L475)
( config )
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.config) **config** ([LlamaForCausalLM](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaForCausalLM)) ‚Äî Model configuration class with all the parameters of the model. Initializing with a config file does not load the weights associated with the model, only the configuration. Check out the [from_pretrained()](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/model#transformers.PreTrainedModel.from_pretrained) method to load the model weights.


The Llama Model for causal language modeling.
This model inherits from [PreTrainedModel](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/model#transformers.PreTrainedModel). Check the superclass documentation for the generic methods the library implements for all its model (such as downloading or saving, resizing the input embeddings, pruning heads etc.)
This model is also a PyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module) subclass. Use it as a regular PyTorch Module and refer to the PyTorch documentation for all matter related to general usage and behavior.
#### forward
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/modeling_llama.py#L508)
( input_ids: typing.Optional[torch.LongTensor] = Noneattention_mask: typing.Optional[torch.Tensor] = Noneposition_ids: typing.Optional[torch.LongTensor] = Nonepast_key_values: typing.Optional[transformers.cache_utils.Cache] = Noneinputs_embeds: typing.Optional[torch.FloatTensor] = Nonelabels: typing.Optional[torch.LongTensor] = Noneuse_cache: typing.Optional[bool] = Noneoutput_attentions: typing.Optional[bool] = Noneoutput_hidden_states: typing.Optional[bool] = Nonecache_position: typing.Optional[torch.LongTensor] = Nonelogits_to_keep: typing.Union[int, torch.Tensor] = 0**kwargs: typing_extensions.Unpack[transformers.models.llama.modeling_llama.KwargsForCausalLM] ) ‚Üí [transformers.modeling_outputs.CausalLMOutputWithPast](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/output#transformers.modeling_outputs.CausalLMOutputWithPast) or `tuple(torch.FloatTensor)`
Expand 11 parameters
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.input_ids) **input_ids** (`torch.LongTensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Indices of input sequence tokens in the vocabulary. Padding will be ignored by default. 
Indices can be obtained using [AutoTokenizer](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/auto#transformers.AutoTokenizer). See [PreTrainedTokenizer.encode()](https://huggingface.co/docs/transformers/v4.53.3/en/internal/tokenization_utils#transformers.PreTrainedTokenizerBase.encode) and [PreTrainedTokenizer.**call**()](https://huggingface.co/docs/transformers/v4.53.3/en/internal/tokenization_utils#transformers.PreTrainedTokenizerBase.__call__) for details.
[What are input IDs?](https://huggingface.co/docs/transformers/glossary#input-ids)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.attention_mask) **attention_mask** (`torch.Tensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Mask to avoid performing attention on padding token indices. Mask values selected in `[0, 1]`: 
    * 1 for tokens that are **not masked** ,
    * 0 for tokens that are **masked**.
[What are attention masks?](https://huggingface.co/docs/transformers/glossary#attention-mask)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.position_ids) **position_ids** (`torch.LongTensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Indices of positions of each input sequence tokens in the position embeddings. Selected in the range `[0, config.n_positions - 1]`. 
[What are position IDs?](https://huggingface.co/docs/transformers/glossary#position-ids)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.past_key_values) **past_key_values** (`~cache_utils.Cache`, _optional_) ‚Äî Pre-computed hidden-states (key and values in the self-attention blocks and in the cross-attention blocks) that can be used to speed up sequential decoding. This typically consists in the `past_key_values` returned by the model at a previous stage of decoding, when `use_cache=True` or `config.use_cache=True`. 
Two formats are allowed:
    * a [Cache](https://huggingface.co/docs/transformers/v4.53.3/en/internal/generation_utils#transformers.Cache) instance, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache);
    * Tuple of `tuple(torch.FloatTensor)` of length `config.n_layers`, with each tuple having 2 tensors of shape `(batch_size, num_heads, sequence_length, embed_size_per_head)`). This is also known as the legacy cache format.
The model will output the same cache format that is fed as input. If no `past_key_values` are passed, the legacy cache format will be returned.
If `past_key_values` are used, the user can optionally input only the last `input_ids` (those that don‚Äôt have their past key value states given to this model) of shape `(batch_size, 1)` instead of all `input_ids` of shape `(batch_size, sequence_length)`.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.inputs_embeds) **inputs_embeds** (`torch.FloatTensor` of shape `(batch_size, sequence_length, hidden_size)`, _optional_) ‚Äî Optionally, instead of passing `input_ids` you can choose to directly pass an embedded representation. This is useful if you want more control over how to convert `input_ids` indices into associated vectors than the model‚Äôs internal embedding lookup matrix.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.labels) **labels** (`torch.LongTensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Labels for computing the masked language modeling loss. Indices should either be in `[0, ..., config.vocab_size]` or -100 (see `input_ids` docstring). Tokens with indices set to `-100` are ignored (masked), the loss is only computed for the tokens with labels in `[0, ..., config.vocab_size]`.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.use_cache) **use_cache** (`bool`, _optional_) ‚Äî If set to `True`, `past_key_values` key value states are returned and can be used to speed up decoding (see `past_key_values`).
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.output_attentions) **output_attentions** (`bool`, _optional_) ‚Äî Whether or not to return the attentions tensors of all attention layers. See `attentions` under returned tensors for more detail.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.output_hidden_states) **output_hidden_states** (`bool`, _optional_) ‚Äî Whether or not to return the hidden states of all layers. See `hidden_states` under returned tensors for more detail.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.cache_position) **cache_position** (`torch.LongTensor` of shape `(sequence_length)`, _optional_) ‚Äî Indices depicting the position of the input sequence tokens in the sequence. Contrarily to `position_ids`, this tensor is not affected by padding. It is used to update the cache in the correct position and to infer the complete sequence length.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.logits_to_keep) **logits_to_keep** (`Union[int, torch.Tensor]`, defaults to `0`) ‚Äî If an `int`, compute logits for the last `logits_to_keep` tokens. If `0`, calculate logits for all `input_ids` (special case). Only last token logits are needed for generation, and calculating them only for that token can save memory, which becomes pretty significant for long sequences or large vocabulary size. If a `torch.Tensor`, must be 1D corresponding to the indices to keep in the sequence length dimension. This is useful when using packed tensor format (single dimension for batch and sequence length).


Returns
[transformers.modeling_outputs.CausalLMOutputWithPast](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/output#transformers.modeling_outputs.CausalLMOutputWithPast) or `tuple(torch.FloatTensor)`
A [transformers.modeling_outputs.CausalLMOutputWithPast](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/output#transformers.modeling_outputs.CausalLMOutputWithPast) or a tuple of `torch.FloatTensor` (if `return_dict=False` is passed or when `config.return_dict=False`) comprising various elements depending on the configuration ([LlamaConfig](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaConfig)) and inputs.
  * **loss** (`torch.FloatTensor` of shape `(1,)`, _optional_ , returned when `labels` is provided) ‚Äî Language modeling loss (for next-token prediction).
  * **logits** (`torch.FloatTensor` of shape `(batch_size, sequence_length, config.vocab_size)`) ‚Äî Prediction scores of the language modeling head (scores for each vocabulary token before SoftMax).
  * **past_key_values** (`Cache`, _optional_ , returned when `use_cache=True` is passed or when `config.use_cache=True`) ‚Äî It is a [Cache](https://huggingface.co/docs/transformers/v4.53.3/en/internal/generation_utils#transformers.Cache) instance. For more details, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache).
Contains pre-computed hidden-states (key and values in the self-attention blocks) that can be used (see `past_key_values` input) to speed up sequential decoding.
  * **hidden_states** (`tuple(torch.FloatTensor)`, _optional_ , returned when `output_hidden_states=True` is passed or when `config.output_hidden_states=True`) ‚Äî Tuple of `torch.FloatTensor` (one for the output of the embeddings, if the model has an embedding layer, + one for the output of each layer) of shape `(batch_size, sequence_length, hidden_size)`.
Hidden-states of the model at the output of each layer plus the optional initial embedding outputs.
  * **attentions** (`tuple(torch.FloatTensor)`, _optional_ , returned when `output_attentions=True` is passed or when `config.output_attentions=True`) ‚Äî Tuple of `torch.FloatTensor` (one for each layer) of shape `(batch_size, num_heads, sequence_length, sequence_length)`.
Attentions weights after the attention softmax, used to compute the weighted average in the self-attention heads.


The [LlamaForCausalLM](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaForCausalLM) forward method, overrides the `__call__` special method.
Although the recipe for forward pass needs to be defined within this function, one should call the `Module` instance afterwards instead of this since the former takes care of running the pre and post processing steps while the latter silently ignores them.
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM.forward.example)
Example:
Copied
```
>>> from transformers import AutoTokenizer, LlamaForCausalLM
>>> model = LlamaForCausalLM.from_pretrained("meta-llama/Llama-2-7b-hf")
>>> tokenizer = AutoTokenizer.from_pretrained("meta-llama/Llama-2-7b-hf")
>>> prompt = "Hey, are you conscious? Can you talk to me?"
>>> inputs = tokenizer(prompt, return_tensors="pt")
>>> # Generate
>>> generate_ids = model.generate(inputs.input_ids, max_length=30)
>>> tokenizer.batch_decode(generate_ids, skip_special_tokens=True, clean_up_tokenization_spaces=False)[0]
"Hey, are you conscious? Can you talk to me?\nI'm not conscious, but I can talk to you."
```

## [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification) LlamaForSequenceClassification
### class transformers.LlamaForSequenceClassification
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/modeling_llama.py#L584)
( config )
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.config) **config** ([LlamaForSequenceClassification](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaForSequenceClassification)) ‚Äî Model configuration class with all the parameters of the model. Initializing with a config file does not load the weights associated with the model, only the configuration. Check out the [from_pretrained()](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/model#transformers.PreTrainedModel.from_pretrained) method to load the model weights.


The LLaMa Model transformer with a sequence classification head on top (linear layer).
[LlamaForSequenceClassification](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaForSequenceClassification) uses the last token in order to do the classification, as other causal models (e.g. GPT-2) do.
Since it does classification on the last token, it requires to know the position of the last token. If a `pad_token_id` is defined in the configuration, it finds the last token that is not a padding token in each row. If no `pad_token_id` is defined, it simply takes the last value in each row of the batch. Since it cannot guess the padding tokens when `inputs_embeds` are passed instead of `input_ids`, it does the same (take the last value in each row of the batch).
This model inherits from [PreTrainedModel](https://huggingface.co/docs/transformers/v4.53.3/en/main_classes/model#transformers.PreTrainedModel). Check the superclass documentation for the generic methods the library implements for all its model (such as downloading or saving, resizing the input embeddings, pruning heads etc.)
This model is also a PyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module) subclass. Use it as a regular PyTorch Module and refer to the PyTorch documentation for all matter related to general usage and behavior.
#### forward
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward) [< source >](https://github.com/huggingface/transformers/blob/v4.53.3/src/transformers/models/llama/modeling_llama.py#L614)
( input_ids: typing.Optional[torch.LongTensor] = Noneattention_mask: typing.Optional[torch.Tensor] = Noneposition_ids: typing.Optional[torch.LongTensor] = Nonepast_key_values: typing.Optional[transformers.cache_utils.Cache] = Noneinputs_embeds: typing.Optional[torch.FloatTensor] = Nonelabels: typing.Optional[torch.LongTensor] = Noneuse_cache: typing.Optional[bool] = Noneoutput_attentions: typing.Optional[bool] = Noneoutput_hidden_states: typing.Optional[bool] = None ) ‚Üí `transformers.modeling_outputs.SequenceClassifierOutputWithPast` or `tuple(torch.FloatTensor)`
Expand 9 parameters
Parameters 
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.input_ids) **input_ids** (`torch.LongTensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Indices of input sequence tokens in the vocabulary. Padding will be ignored by default. 
Indices can be obtained using [AutoTokenizer](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/auto#transformers.AutoTokenizer). See [PreTrainedTokenizer.encode()](https://huggingface.co/docs/transformers/v4.53.3/en/internal/tokenization_utils#transformers.PreTrainedTokenizerBase.encode) and [PreTrainedTokenizer.**call**()](https://huggingface.co/docs/transformers/v4.53.3/en/internal/tokenization_utils#transformers.PreTrainedTokenizerBase.__call__) for details.
[What are input IDs?](https://huggingface.co/docs/transformers/glossary#input-ids)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.attention_mask) **attention_mask** (`torch.Tensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Mask to avoid performing attention on padding token indices. Mask values selected in `[0, 1]`: 
    * 1 for tokens that are **not masked** ,
    * 0 for tokens that are **masked**.
[What are attention masks?](https://huggingface.co/docs/transformers/glossary#attention-mask)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.position_ids) **position_ids** (`torch.LongTensor` of shape `(batch_size, sequence_length)`, _optional_) ‚Äî Indices of positions of each input sequence tokens in the position embeddings. Selected in the range `[0, config.n_positions - 1]`. 
[What are position IDs?](https://huggingface.co/docs/transformers/glossary#position-ids)
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.past_key_values) **past_key_values** (`~cache_utils.Cache`, _optional_) ‚Äî Pre-computed hidden-states (key and values in the self-attention blocks and in the cross-attention blocks) that can be used to speed up sequential decoding. This typically consists in the `past_key_values` returned by the model at a previous stage of decoding, when `use_cache=True` or `config.use_cache=True`. 
Two formats are allowed:
    * a [Cache](https://huggingface.co/docs/transformers/v4.53.3/en/internal/generation_utils#transformers.Cache) instance, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache);
    * Tuple of `tuple(torch.FloatTensor)` of length `config.n_layers`, with each tuple having 2 tensors of shape `(batch_size, num_heads, sequence_length, embed_size_per_head)`). This is also known as the legacy cache format.
The model will output the same cache format that is fed as input. If no `past_key_values` are passed, the legacy cache format will be returned.
If `past_key_values` are used, the user can optionally input only the last `input_ids` (those that don‚Äôt have their past key value states given to this model) of shape `(batch_size, 1)` instead of all `input_ids` of shape `(batch_size, sequence_length)`.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.inputs_embeds) **inputs_embeds** (`torch.FloatTensor` of shape `(batch_size, sequence_length, hidden_size)`, _optional_) ‚Äî Optionally, instead of passing `input_ids` you can choose to directly pass an embedded representation. This is useful if you want more control over how to convert `input_ids` indices into associated vectors than the model‚Äôs internal embedding lookup matrix.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.labels) **labels** (`torch.LongTensor` of shape `(batch_size,)`, _optional_) ‚Äî Labels for computing the sequence classification/regression loss. Indices should be in `[0, ..., config.num_labels - 1]`. If `config.num_labels == 1` a regression loss is computed (Mean-Square loss), If `config.num_labels > 1` a classification loss is computed (Cross-Entropy).
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.use_cache) **use_cache** (`bool`, _optional_) ‚Äî If set to `True`, `past_key_values` key value states are returned and can be used to speed up decoding (see `past_key_values`).
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.output_attentions) **output_attentions** (`bool`, _optional_) ‚Äî Whether or not to return the attentions tensors of all attention layers. See `attentions` under returned tensors for more detail.
  * [](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.output_hidden_states) **output_hidden_states** (`bool`, _optional_) ‚Äî Whether or not to return the hidden states of all layers. See `hidden_states` under returned tensors for more detail.


Returns
`transformers.modeling_outputs.SequenceClassifierOutputWithPast` or `tuple(torch.FloatTensor)`
A `transformers.modeling_outputs.SequenceClassifierOutputWithPast` or a tuple of `torch.FloatTensor` (if `return_dict=False` is passed or when `config.return_dict=False`) comprising various elements depending on the configuration ([LlamaConfig](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaConfig)) and inputs.
  * **loss** (`torch.FloatTensor` of shape `(1,)`, _optional_ , returned when `labels` is provided) ‚Äî Classification (or regression if config.num_labels==1) loss.
  * **logits** (`torch.FloatTensor` of shape `(batch_size, config.num_labels)`) ‚Äî Classification (or regression if config.num_labels==1) scores (before SoftMax).
  * **past_key_values** (`Cache`, _optional_ , returned when `use_cache=True` is passed or when `config.use_cache=True`) ‚Äî It is a [Cache](https://huggingface.co/docs/transformers/v4.53.3/en/internal/generation_utils#transformers.Cache) instance. For more details, see our [kv cache guide](https://huggingface.co/docs/transformers/en/kv_cache).
Contains pre-computed hidden-states (key and values in the self-attention blocks) that can be used (see `past_key_values` input) to speed up sequential decoding.
  * **hidden_states** (`tuple(torch.FloatTensor)`, _optional_ , returned when `output_hidden_states=True` is passed or when `config.output_hidden_states=True`) ‚Äî Tuple of `torch.FloatTensor` (one for the output of the embeddings, if the model has an embedding layer, + one for the output of each layer) of shape `(batch_size, sequence_length, hidden_size)`.
Hidden-states of the model at the output of each layer plus the optional initial embedding outputs.
  * **attentions** (`tuple(torch.FloatTensor)`, _optional_ , returned when `output_attentions=True` is passed or when `config.output_attentions=True`) ‚Äî Tuple of `torch.FloatTensor` (one for each layer) of shape `(batch_size, num_heads, sequence_length, sequence_length)`.
Attentions weights after the attention softmax, used to compute the weighted average in the self-attention heads.


The [LlamaForSequenceClassification](https://huggingface.co/docs/transformers/v4.53.3/en/model_doc/llama#transformers.LlamaForSequenceClassification) forward method, overrides the `__call__` special method.
Although the recipe for forward pass needs to be defined within this function, one should call the `Module` instance afterwards instead of this since the former takes care of running the pre and post processing steps while the latter silently ignores them.
[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.example)
Example of single-label classification:
Copied
```
>>> import torch
>>> from transformers import AutoTokenizer, LlamaForSequenceClassification
>>> tokenizer = AutoTokenizer.from_pretrained("meta-llama/Llama-2-7b-hf")
>>> model = LlamaForSequenceClassification.from_pretrained("meta-llama/Llama-2-7b-hf")
>>> inputs = tokenizer("Hello, my dog is cute", return_tensors="pt")
>>> with torch.no_grad():
...   logits = model(**inputs).logits
>>> predicted_class_id = logits.argmax().item()
>>> model.config.id2label[predicted_class_id]
...
>>> # To train a model on `num_labels` classes, you can pass `num_labels=num_labels` to `.from_pretrained(...)`
>>> num_labels = len(model.config.id2label)
>>> model = LlamaForSequenceClassification.from_pretrained("meta-llama/Llama-2-7b-hf", num_labels=num_labels)
>>> labels = torch.tensor([1])
>>> loss = model(**inputs, labels=labels).loss
>>> round(loss.item(), 2)
...
```

[](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification.forward.example-2)
Example of multi-label classification:
Copied
```
>>> import torch
>>> from transformers import AutoTokenizer, LlamaForSequenceClassification
>>> tokenizer = AutoTokenizer.from_pretrained("meta-llama/Llama-2-7b-hf")
>>> model = LlamaForSequenceClassification.from_pretrained("meta-llama/Llama-2-7b-hf", problem_type="multi_label_classification")
>>> inputs = tokenizer("Hello, my dog is cute", return_tensors="pt")
>>> with torch.no_grad():
...   logits = model(**inputs).logits
>>> predicted_class_ids = torch.arange(0, logits.shape[-1])[torch.sigmoid(logits).squeeze(dim=0) > 0.5]
>>> # To train a model on `num_labels` classes, you can pass `num_labels=num_labels` to `.from_pretrained(...)`
>>> num_labels = len(model.config.id2label)
>>> model = LlamaForSequenceClassification.from_pretrained(
...   "meta-llama/Llama-2-7b-hf", num_labels=num_labels, problem_type="multi_label_classification"
... )
>>> labels = torch.sum(
...   torch.nn.functional.one_hot(predicted_class_ids[None, :].clone(), num_classes=num_labels), dim=1
... ).to(torch.float)
>>> loss = model(**inputs, labels=labels).loss
```

[< > Update on GitHub](https://github.com/huggingface/transformers/blob/main/docs/source/en/model_doc/llama2.md)
[‚ÜêLLaMA](https://huggingface.co/docs/transformers/model_doc/llama) [Llama3‚Üí](https://huggingface.co/docs/transformers/model_doc/llama3)
[Llama 2](https://huggingface.co/docs/transformers/model_doc/llama2#llama-2) [Notes](https://huggingface.co/docs/transformers/model_doc/llama2#notes) [LlamaConfig](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaConfig) [LlamaTokenizer](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizer) [LlamaTokenizerFast](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaTokenizerFast) [LlamaModel](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaModel) [LlamaForCausalLM](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForCausalLM) [LlamaForSequenceClassification](https://huggingface.co/docs/transformers/model_doc/llama2#transformers.LlamaForSequenceClassification)


## Source Information
- URL: https://huggingface.co/docs/transformers/model_doc/llama2
- Harvested: 2025-08-19T12:37:25.249290
- Profile: api_documentation
- Agent: architect
