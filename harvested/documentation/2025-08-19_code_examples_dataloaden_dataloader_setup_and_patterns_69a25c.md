---
agent_context: architect
confidence: 0.95
harvested_at: '2025-08-19T15:10:19.834738'
profile: code_examples
source: https://github.com/vikstrous/dataloadgen
topic: dataloaden dataloader setup and patterns
---

# dataloaden dataloader setup and patterns

[Skip to content](https://github.com/vikstrous/dataloadgen#start-of-content)
## Navigation Menu
Toggle navigation
[ ](https://github.com/)
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fvikstrous%2Fdataloadgen)
Appearance settings
  * Product 
    * [ GitHub Copilot  Write better code with AI  ](https://github.com/features/copilot)
    * [ GitHub Spark  New  Build and deploy intelligent apps  ](https://github.com/features/spark)
    * [ GitHub Models  New  Manage and compare prompts  ](https://github.com/features/models)
    * [ GitHub Advanced Security  Find and fix vulnerabilities  ](https://github.com/security/advanced-security)
    * [ Actions  Automate any workflow  ](https://github.com/features/actions)
    * [ Codespaces  Instant dev environments  ](https://github.com/features/codespaces)
    * [ Issues  Plan and track work  ](https://github.com/features/issues)
    * [ Code Review  Manage code changes  ](https://github.com/features/code-review)
    * [ Discussions  Collaborate outside of code  ](https://github.com/features/discussions)
    * [ Code Search  Find more, search less  ](https://github.com/features/code-search)
Explore
    * [ Why GitHub ](https://github.com/why-github)
    * [ All features ](https://github.com/features)
    * [ Documentation ](https://docs.github.com)
    * [ GitHub Skills ](https://skills.github.com)
    * [ Blog ](https://github.blog)
  * Solutions 
By company size
    * [ Enterprises ](https://github.com/enterprise)
    * [ Small and medium teams ](https://github.com/team)
    * [ Startups ](https://github.com/enterprise/startups)
    * [ Nonprofits ](https://github.com/solutions/industry/nonprofits)
By use case
    * [ DevSecOps ](https://github.com/solutions/use-case/devsecops)
    * [ DevOps ](https://github.com/solutions/use-case/devops)
    * [ CI/CD ](https://github.com/solutions/use-case/ci-cd)
    * [ View all use cases ](https://github.com/solutions/use-case)
By industry
    * [ Healthcare ](https://github.com/solutions/industry/healthcare)
    * [ Financial services ](https://github.com/solutions/industry/financial-services)
    * [ Manufacturing ](https://github.com/solutions/industry/manufacturing)
    * [ Government ](https://github.com/solutions/industry/government)
    * [ View all industries ](https://github.com/solutions/industry)
[ View all solutions ](https://github.com/solutions)
  * Resources 
Topics
    * [ AI ](https://github.com/resources/articles/ai)
    * [ DevOps ](https://github.com/resources/articles/devops)
    * [ Security ](https://github.com/resources/articles/security)
    * [ Software Development ](https://github.com/resources/articles/software-development)
    * [ View all ](https://github.com/resources/articles)
Explore
    * [ Learning Pathways ](https://resources.github.com/learn/pathways)
    * [ Events & Webinars ](https://resources.github.com)
    * [ Ebooks & Whitepapers ](https://github.com/resources/whitepapers)
    * [ Customer Stories ](https://github.com/customer-stories)
    * [ Partners ](https://partner.github.com)
    * [ Executive Insights ](https://github.com/solutions/executive-insights)
  * Open Source 
    * [ GitHub Sponsors  Fund open source developers  ](https://github.com/sponsors)
    * [ The ReadME Project  GitHub community articles  ](https://github.com/readme)
Repositories
    * [ Topics ](https://github.com/topics)
    * [ Trending ](https://github.com/trending)
    * [ Collections ](https://github.com/collections)
  * Enterprise 
    * [ Enterprise platform  AI-powered developer platform  ](https://github.com/enterprise)
Available add-ons
    * [ GitHub Advanced Security  Enterprise-grade security features  ](https://github.com/security/advanced-security)
    * [ Copilot for business  Enterprise-grade AI features  ](https://github.com/features/copilot/copilot-business)
    * [ Premium Support  Enterprise-grade 24/7 support  ](https://github.com/premium-support)
  * [Pricing](https://github.com/pricing)


Search or jump to...
# Search code, repositories, users, issues, pull requests...
Search 
Clear
[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)
#  Provide feedback 
We read every piece of feedback, and take your input very seriously.
Include my email address so I can be contacted
Cancel  Submit feedback 
#  Saved searches 
## Use saved searches to filter your results more quickly
Name
Query
To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax). 
Cancel  Create saved search 
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fvikstrous%2Fdataloadgen)
[ Sign up ](https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=vikstrous%2Fdataloadgen)
Appearance settings
Resetting focus
You signed in with another tab or window. [Reload](https://github.com/vikstrous/dataloadgen) to refresh your session. You signed out in another tab or window. [Reload](https://github.com/vikstrous/dataloadgen) to refresh your session. You switched accounts on another tab or window. [Reload](https://github.com/vikstrous/dataloadgen) to refresh your session. Dismiss alert
{{ message }}
[ vikstrous ](https://github.com/vikstrous) / **[dataloadgen](https://github.com/vikstrous/dataloadgen) ** Public
  * [ Notifications ](https://github.com/login?return_to=%2Fvikstrous%2Fdataloadgen) You must be signed in to change notification settings
  * [ Fork 15 ](https://github.com/login?return_to=%2Fvikstrous%2Fdataloadgen)
  * [ Star  97 ](https://github.com/login?return_to=%2Fvikstrous%2Fdataloadgen)


An implementation of Facebook's DataLoader in Go 
### License
[ MIT license ](https://github.com/vikstrous/dataloadgen/blob/master/license.md)
[ 97 stars ](https://github.com/vikstrous/dataloadgen/stargazers) [ 15 forks ](https://github.com/vikstrous/dataloadgen/forks) [ Branches ](https://github.com/vikstrous/dataloadgen/branches) [ Tags ](https://github.com/vikstrous/dataloadgen/tags) [ Activity ](https://github.com/vikstrous/dataloadgen/activity)
[ Star  ](https://github.com/login?return_to=%2Fvikstrous%2Fdataloadgen)
[ Notifications ](https://github.com/login?return_to=%2Fvikstrous%2Fdataloadgen) You must be signed in to change notification settings
  * [ Code ](https://github.com/vikstrous/dataloadgen)
  * [ Issues 1 ](https://github.com/vikstrous/dataloadgen/issues)
  * [ Pull requests 0 ](https://github.com/vikstrous/dataloadgen/pulls)
  * [ Actions ](https://github.com/vikstrous/dataloadgen/actions)
  * [ Projects 0 ](https://github.com/vikstrous/dataloadgen/projects)
  * [ Security ](https://github.com/vikstrous/dataloadgen/security)
[ ](https://github.com/vikstrous/dataloadgen/security)
[ ](https://github.com/vikstrous/dataloadgen/security)
[ ](https://github.com/vikstrous/dataloadgen/security)
### [ Uh oh!  ](https://github.com/vikstrous/dataloadgen/security)
[There was an error while loading. ](https://github.com/vikstrous/dataloadgen/security)[Please reload this page](https://github.com/vikstrous/dataloadgen).
  * [ Insights ](https://github.com/vikstrous/dataloadgen/pulse)


Additional navigation options
  * [ Code  ](https://github.com/vikstrous/dataloadgen)
  * [ Issues  ](https://github.com/vikstrous/dataloadgen/issues)
  * [ Pull requests  ](https://github.com/vikstrous/dataloadgen/pulls)
  * [ Actions  ](https://github.com/vikstrous/dataloadgen/actions)
  * [ Projects  ](https://github.com/vikstrous/dataloadgen/projects)
  * [ Security  ](https://github.com/vikstrous/dataloadgen/security)
  * [ Insights  ](https://github.com/vikstrous/dataloadgen/pulse)


# vikstrous/dataloadgen
master
[Branches](https://github.com/vikstrous/dataloadgen/branches)[Tags](https://github.com/vikstrous/dataloadgen/tags)
[](https://github.com/vikstrous/dataloadgen/branches)[](https://github.com/vikstrous/dataloadgen/tags)
Go to file
Code
Open more actions menu
## Folders and files
Name| Name| Last commit message| Last commit date  
---|---|---|---  
## Latest commit
## History
[80 Commits](https://github.com/vikstrous/dataloadgen/commits/master/)[](https://github.com/vikstrous/dataloadgen/commits/master/)  
[benchmark](https://github.com/vikstrous/dataloadgen/tree/master/benchmark "benchmark")| [benchmark](https://github.com/vikstrous/dataloadgen/tree/master/benchmark "benchmark")| |   
[.gitignore](https://github.com/vikstrous/dataloadgen/blob/master/.gitignore ".gitignore")| [.gitignore](https://github.com/vikstrous/dataloadgen/blob/master/.gitignore ".gitignore")| |   
[10_concurrently.png](https://github.com/vikstrous/dataloadgen/blob/master/10_concurrently.png "10_concurrently.png")| [10_concurrently.png](https://github.com/vikstrous/dataloadgen/blob/master/10_concurrently.png "10_concurrently.png")| |   
[README.md](https://github.com/vikstrous/dataloadgen/blob/master/README.md "README.md")| [README.md](https://github.com/vikstrous/dataloadgen/blob/master/README.md "README.md")| |   
[all_in_one_request.png](https://github.com/vikstrous/dataloadgen/blob/master/all_in_one_request.png "all_in_one_request.png")| [all_in_one_request.png](https://github.com/vikstrous/dataloadgen/blob/master/all_in_one_request.png "all_in_one_request.png")| |   
[cached.png](https://github.com/vikstrous/dataloadgen/blob/master/cached.png "cached.png")| [cached.png](https://github.com/vikstrous/dataloadgen/blob/master/cached.png "cached.png")| |   
[dataloaden_test.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloaden_test.go "dataloaden_test.go")| [dataloaden_test.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloaden_test.go "dataloaden_test.go")| |   
[dataloader_test.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloader_test.go "dataloader_test.go")| [dataloader_test.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloader_test.go "dataloader_test.go")| |   
[dataloadgen.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloadgen.go "dataloadgen.go")| [dataloadgen.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloadgen.go "dataloadgen.go")| |   
[dataloadgen_test.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloadgen_test.go "dataloadgen_test.go")| [dataloadgen_test.go](https://github.com/vikstrous/dataloadgen/blob/master/dataloadgen_test.go "dataloadgen_test.go")| |   
[go.mod](https://github.com/vikstrous/dataloadgen/blob/master/go.mod "go.mod")| [go.mod](https://github.com/vikstrous/dataloadgen/blob/master/go.mod "go.mod")| |   
[go.sum](https://github.com/vikstrous/dataloadgen/blob/master/go.sum "go.sum")| [go.sum](https://github.com/vikstrous/dataloadgen/blob/master/go.sum "go.sum")| |   
[go.work](https://github.com/vikstrous/dataloadgen/blob/master/go.work "go.work")| [go.work](https://github.com/vikstrous/dataloadgen/blob/master/go.work "go.work")| |   
[init.png](https://github.com/vikstrous/dataloadgen/blob/master/init.png "init.png")| [init.png](https://github.com/vikstrous/dataloadgen/blob/master/init.png "init.png")| |   
[license.md](https://github.com/vikstrous/dataloadgen/blob/master/license.md "license.md")| [license.md](https://github.com/vikstrous/dataloadgen/blob/master/license.md "license.md")| |   
[unique_keys.png](https://github.com/vikstrous/dataloadgen/blob/master/unique_keys.png "unique_keys.png")| [unique_keys.png](https://github.com/vikstrous/dataloadgen/blob/master/unique_keys.png "unique_keys.png")| |   
View all files  
## Repository files navigation
  * [README](https://github.com/vikstrous/dataloadgen)
  * [MIT license](https://github.com/vikstrous/dataloadgen)


# dataloadgen
[](https://github.com/vikstrous/dataloadgen#dataloadgen)
[![Go Reference](https://camo.githubusercontent.com/aabc9604f1f96a9720aa97871f32a51b0892fcb06756c12dc234157c42423fc8/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f76696b7374726f75732f646174616c6f616467656e2e737667)](https://pkg.go.dev/github.com/vikstrous/dataloadgen)
`dataloadgen` is an implementation of a pattern popularized by [Facebook's DataLoader](https://github.com/graphql/dataloader).
It works as follows:
  * A Loader object is created per graphql request.
  * Each of many concurrently executing graphql resolver functions call `Load()` on the Loader object with different keys. Let's say `K1`, `K2`, `K3`
  * Each call to `Load()` with a new key is delayed slightly (a few milliseconds) so that the Loader can load them together.
  * The customizable `fetch` function of the loader takes a list of keys and loads data for all of them in a single batched request to the data storage layer. It might send `[K1,K2,K3]` and get back `[V1,V2,V3]`. The order of the keys must match the order of the values. 
    * Alternatively, the `mappedFetch` function of the loader takes a list of keys and returns a map instead of a list. It might send `[K1, K2, K3]` and get back `{K1: V1, K2: V2, K3: V3}`.
  * The Loader takes care of sending the right result to the right caller and the result is cached for the duration of the graphql request.


Note
The `fetch` method expects the returned list to correspond to the provided keys in the same order. Alternatively, the `mappedFetch` allows returning a map, ensuring correct ordering and automatic creation of the `ErrNotFound` error for missing values.
Usage:
```
go get github.com/vikstrous/dataloadgen
```

See the usage [example](https://pkg.go.dev/github.com/vikstrous/dataloadgen#example-Loader) in the documentation:
```
package main
import (
	"context"
	"fmt"
	"strconv"
	"github.com/vikstrous/dataloadgen"
)
// fetchFn/mappedFetchFn is shown as a function here, but it might work better as a method
// ctx is the context from the first call to Load for the current batch
func fetchFn(ctx context.Context, keys []string) (ret []int, errs []error) {
  for _, key := range keys {
    num, err := strconv.ParseInt(key, 10, 32)
    ret = append(ret, int(num))
    errs = append(errs, err)
  }
  return
}
func mappedFetchFn(ctx context.Context, keys []string) (ret map[string]int, err error) {
	ret = make(map[string]int, len(keys))
	errs := make(map[string]error, len(keys))
  for _, key := range keys {
    num, err := strconv.ParseInt(key, 10, 32)
    ret[key] = int(num)
    errs[key] = err
  }
	// You can also return a single error, returned for every key's load invocation, instead of this MappedFetchError.
  err = dataloadgen.MappedFetchError[string](errs)
  return
}
func main() {
  ctx := context.Background()
	
  // Per-request setup code. Either:
  loader := dataloadgen.NewLoader(fetchFn)
  // or
  loader := dataloadgen.NewMappedLoader(mappedFetchFn)
	
  // In every graphql resolver:
  result, err := loader.Load(ctx, "1")
  if err != nil {
    panic(err)
  }
  fmt.Println(result)
}
```

## Comparison to others
[](https://github.com/vikstrous/dataloadgen#comparison-to-others)
  * [dataloaden](https://github.com/vektah/dataloaden) uses code generation and has similar performance
  * [dataloader](https://github.com/graph-gophers/dataloader) does not use code generation but has much worse performance and is more difficult to use
  * [yckao/go-dataloader](https://github.com/yckao/go-dataloader) does not use code generation but has much worse performance and is very similar to dataloader.


The benchmarks in this repo show that this package is faster than all of the above and I also find it easier to use.
Benchmark data as CSV
```
Benchmark,Package,iterations,ns/op,B/op,allocs/op
init-8,graph-gophers/dataloader,"9,242,047.00",130.50,208.00,3.00
init-8,vektah/dataloaden,"1,000,000,000.00",0.27,0.00,0.00
init-8,yckao/go-dataloader,"3,153,999.00",402.10,400.00,10.00
init-8,vikstrous/dataloadgen,"10,347,595.00",114.90,128.00,3.00
cached-8,graph-gophers/dataloader,"4,669.00","222,072.00","25,307.00",522.00
cached-8,vektah/dataloaden,"1,243.00","1,037,044.00","5,234.00",110.00
cached-8,yckao/go-dataloader,"2,312.00","580,860.00","2,273.00",130.00
cached-8,vikstrous/dataloadgen,"1,552.00","824,939.00",776.00,15.00
unique_keys-8,graph-gophers/dataloader,"12,334.00","97,118.00","56,314.00",945.00
unique_keys-8,vektah/dataloaden,"36,489.00","32,507.00","37,514.00",227.00
unique_keys-8,yckao/go-dataloader,"8,055.00","133,224.00","50,180.00",747.00
unique_keys-8,vikstrous/dataloadgen,"42,943.00","27,257.00","22,255.00",230.00
10_concurrently-8,graph-gophers/dataloader,326.00,"11,119,367.00","5,574,460.00","164,247.00"
10_concurrently-8,vektah/dataloaden,100.00,"194,627,574.00","898,977.00","19,502.00"
10_concurrently-8,yckao/go-dataloader,278.00,"10,972,399.00","314,963.00","29,558.00"
10_concurrently-8,vikstrous/dataloadgen,643.00,"8,249,158.00","43,474.00",806.00
all_in_one_request-8,graph-gophers/dataloader,28.00,"39,954,324.00","27,475,136.00","158,321.00"
all_in_one_request-8,vektah/dataloaden,328.00,"3,713,407.00","3,533,086.00","41,368.00"
all_in_one_request-8,yckao/go-dataloader,132.00,"9,060,571.00","4,886,722.00","102,564.00"
all_in_one_request-8,vikstrous/dataloadgen,375.00,"3,206,175.00","2,518,498.00","41,582.00"

```

[![](https://github.com/vikstrous/dataloadgen/raw/master/init.png)](https://github.com/vikstrous/dataloadgen/blob/master/init.png) [![](https://github.com/vikstrous/dataloadgen/raw/master/cached.png)](https://github.com/vikstrous/dataloadgen/blob/master/cached.png) [![](https://github.com/vikstrous/dataloadgen/raw/master/unique_keys.png)](https://github.com/vikstrous/dataloadgen/blob/master/unique_keys.png) [![](https://github.com/vikstrous/dataloadgen/raw/master/10_concurrently.png)](https://github.com/vikstrous/dataloadgen/blob/master/10_concurrently.png) [![](https://github.com/vikstrous/dataloadgen/raw/master/all_in_one_request.png)](https://github.com/vikstrous/dataloadgen/blob/master/all_in_one_request.png)
To run the benchmarks, run `go test -bench=. . -run BenchmarkAll -benchmem` from the benchmark directory.
## About
An implementation of Facebook's DataLoader in Go 
### Topics
[ graphql ](https://github.com/topics/graphql "Topic: graphql") [ dataloader ](https://github.com/topics/dataloader "Topic: dataloader") [ gqlgen ](https://github.com/topics/gqlgen "Topic: gqlgen")
### Resources
[ Readme ](https://github.com/vikstrous/dataloadgen#readme-ov-file)
### License
[ MIT license ](https://github.com/vikstrous/dataloadgen#MIT-1-ov-file)
###  Uh oh! 
There was an error while loading. [Please reload this page](https://github.com/vikstrous/dataloadgen).
[ Activity](https://github.com/vikstrous/dataloadgen/activity)
### Stars
[ **97** stars](https://github.com/vikstrous/dataloadgen/stargazers)
### Watchers
[ **3** watching](https://github.com/vikstrous/dataloadgen/watchers)
### Forks
[ **15** forks](https://github.com/vikstrous/dataloadgen/forks)
[ Report repository ](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fvikstrous%2Fdataloadgen&report=vikstrous+%28user%29)
##  [Releases](https://github.com/vikstrous/dataloadgen/releases)
[ 10 tags ](https://github.com/vikstrous/dataloadgen/tags)
##  [Packages 0](https://github.com/users/vikstrous/packages?repo_name=dataloadgen)
No packages published 
###  Uh oh! 
There was an error while loading. [Please reload this page](https://github.com/vikstrous/dataloadgen).
##  [Contributors 8](https://github.com/vikstrous/dataloadgen/graphs/contributors)
  * [ ![@vikstrous](https://avatars.githubusercontent.com/u/482425?s=64&v=4) ](https://github.com/vikstrous)
  * [ ![@gtzo-anchorage](https://avatars.githubusercontent.com/u/112967141?s=64&v=4) ](https://github.com/gtzo-anchorage)
  * [ ![@CodingContraption](https://avatars.githubusercontent.com/u/7326885?s=64&v=4) ](https://github.com/CodingContraption)
  * [ ![@cursoragent](https://avatars.githubusercontent.com/u/199161495?s=64&v=4) ](https://github.com/cursoragent)
  * [ ![@AlexanderArvidsson](https://avatars.githubusercontent.com/u/2972103?s=64&v=4) ](https://github.com/AlexanderArvidsson)
  * [ ![@JFrankfurt](https://avatars.githubusercontent.com/u/5773490?s=64&v=4) ](https://github.com/JFrankfurt)
  * [ ![@Tom-Bury](https://avatars.githubusercontent.com/u/22749794?s=64&v=4) ](https://github.com/Tom-Bury)
  * [ ![@frederikhors](https://avatars.githubusercontent.com/u/41120635?s=64&v=4) ](https://github.com/frederikhors)


## Languages
  * [ Go 100.0% ](https://github.com/vikstrous/dataloadgen/search?l=go)


## Footer
[ ](https://github.com) © 2025 GitHub, Inc. 
### Footer navigation
  * [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
  * [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Docs](https://docs.github.com/)
  * [Contact](https://support.github.com?tags=dotcom-footer)
  * Manage cookies 
  * Do not share my personal information 


You can’t perform that action at this time. 


## Source Information
- URL: https://github.com/vikstrous/dataloadgen
- Harvested: 2025-08-19T15:10:19.834738
- Profile: code_examples
- Agent: architect
