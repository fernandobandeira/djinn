# Pattern Evolution Memory Cell
# Tracks how agent creation patterns improve over time through constraint optimization
# Based on cellular constraint architecture from Zettelkasten insights
---

metadata:
  type: cellular-memory
  purpose: Track pattern evolution and effectiveness
  last_updated: 2025-08-22
  version: 1.1.0

evolution_tracking:
  description: |
    Tracks how patterns evolve through usage and refinement.
    Each pattern has a lineage showing its improvement over time.

  pattern_lineage:
    sub_agent_patterns:
      - pattern_id: "sa_001"
        name: "basic_reviewer"
        creation_date: "2025-08-15"
        parent_pattern: null
        constraint_score: 6.5
        success_rate: 0.75
        iterations: 1
        improvements:
          - "Initial pattern from Ana/Archie examples"

      - pattern_id: "sa_002"
        name: "enhanced_reviewer"
        creation_date: "2025-08-15"
        parent_pattern: "sa_001"
        constraint_score: 8.0
        success_rate: 0.90
        iterations: 3
        improvements:
          - "Added IMPORTANT trigger keyword"
          - "Reduced tool set to minimal"
          - "Clarified output format"

    command_patterns:
      - pattern_id: "cmd_001"
        name: "interactive_assistant"
        creation_date: "2025-08-15"
        parent_pattern: null
        constraint_score: 7.0
        success_rate: 0.80
        iterations: 1
        improvements:
          - "Based on Ana's dialogue pattern"

    orchestration_patterns:
      - pattern_id: "orch_001"
        name: "centralized_context_orchestration"
        creation_date: "2025-08-22"
        parent_pattern: null
        constraint_score: 8.5
        success_rate: 0.92
        iterations: 1
        improvements:
          - "Centralized knowledge discovery in command agents"
          - "Eliminated sub-agent discovery conflicts"
          - "Reduced KB load by 60%"
        source_agent: "PM command"
        extraction_reason: "Successful orchestration fix"

    discovery_patterns:
      - pattern_id: "disc_001" 
        name: "mandatory_kb_discovery"
        creation_date: "2025-08-22"
        parent_pattern: null
        constraint_score: 8.2
        success_rate: 0.89
        iterations: 1
        improvements:
          - "Mandatory KB discovery before content generation"
          - "Reference existing docs requirement"
          - "Gap-only generation approach"
        source_agent: "PM command"
        extraction_reason: "Eliminated content duplication"

    integration_patterns:
      - pattern_id: "intg_001"
        name: "leveraged_agent_integration"
        creation_date: "2025-08-22"
        parent_pattern: null
        constraint_score: 8.3
        success_rate: 0.90
        iterations: 1
        improvements:
          - "Systematic agent capability leverage"
          - "Integration protocol definitions"
          - "Advanced error handling and fallbacks"
        source_agent: "PM command"
        extraction_reason: "Successful cross-agent integration"

effectiveness_metrics:
  description: |
    Metrics to measure pattern effectiveness and guide evolution

  metrics:
    - metric: "constraint_balance"
      description: "Score from constraint analyzer (0-10)"
      weight: 0.3
      optimal_range: [7.5, 8.5]

    - metric: "delegation_success"
      description: "Rate of successful delegations"
      weight: 0.25
      optimal_range: [0.85, 1.0]

    - metric: "user_satisfaction"
      description: "Implicit from rework requests"
      weight: 0.25
      optimal_range: [0.8, 1.0]

    - metric: "resource_efficiency"
      description: "Minimal tool usage"
      weight: 0.2
      optimal_range: [0.7, 0.9]

    - metric: "orchestration_effectiveness"
      description: "Success of multi-agent coordination"
      weight: 0.3
      optimal_range: [0.85, 1.0]
      added_date: "2025-08-22"

pattern_mutations:
  description: |
    Controlled variations to test pattern improvements

  mutation_strategies:
    - type: "constraint_tightening"
      description: "Add more specific constraints when under-constrained"
      trigger: "constraint_score < 6"
      actions:
        - "Add trigger keywords"
        - "Define output format"
        - "Specify scope boundaries"

    - type: "constraint_relaxation"
      description: "Remove overly specific constraints"
      trigger: "constraint_score > 9"
      actions:
        - "Generalize conditions"
        - "Allow format flexibility"
        - "Broaden applicability"

    - type: "tool_optimization"
      description: "Minimize tool set"
      trigger: "resource_efficiency < 0.7"
      actions:
        - "Remove unused tools"
        - "Consolidate similar tools"
        - "Use most efficient tool"

    - type: "orchestration_optimization"
      description: "Improve multi-agent coordination"
      trigger: "orchestration_effectiveness < 0.85"
      actions:
        - "Centralize knowledge discovery"
        - "Eliminate autonomous discovery conflicts"
        - "Implement context passing protocols"
      added_date: "2025-08-22"

learning_signals:
  description: |
    Signals that trigger pattern learning and evolution

  positive_signals:
    - "Agent works on first try"
    - "No rework requested"
    - "Pattern reused successfully"
    - "High constraint balance score"
    - "Successful orchestration without conflicts"
    - "Efficient knowledge discovery"
    - "High cross-agent integration success"

  negative_signals:
    - "Rework requested"
    - "Delegation failure"
    - "Constraint conflicts"
    - "Tool errors"
    - "Discovery conflicts between agents"
    - "Duplicate knowledge base calls"
    - "Integration failures"

pattern_repository:
  description: |
    Storage for successful patterns that can be reused

  categories:
    analysis_patterns:
      count: 3
      average_score: 8.2
      best_pattern: "structured_research_analyst"

    automation_patterns:
      count: 5
      average_score: 7.8
      best_pattern: "test_runner_with_fixes"

    documentation_patterns:
      count: 2
      average_score: 7.5
      best_pattern: "adr_generator"

    utility_patterns:
      count: 4
      average_score: 8.0
      best_pattern: "json_validator_flexible"

    orchestration_patterns:
      count: 1
      average_score: 8.5
      best_pattern: "centralized_context_orchestration"
      added_date: "2025-08-22"

    discovery_patterns:
      count: 1
      average_score: 8.2
      best_pattern: "mandatory_kb_discovery"
      added_date: "2025-08-22"

    integration_patterns:
      count: 1
      average_score: 8.3
      best_pattern: "leveraged_agent_integration"
      added_date: "2025-08-22"

evolution_rules:
  description: |
    Rules governing how patterns evolve

  rules:
    - rule: "Preserve successful constraints"
      description: "Don't modify constraints that work well"

    - rule: "Incremental changes"
      description: "Make one change at a time to isolate effects"

    - rule: "Test before promotion"
      description: "New patterns must prove effectiveness before becoming primary"

    - rule: "Maintain lineage"
      description: "Always track parent patterns for rollback"

    - rule: "Learn from failures"
      description: "Failed patterns provide valuable negative examples"

    - rule: "Extract from successful fixes"
      description: "Immediately extract patterns from successful problem resolutions"
      added_date: "2025-08-22"

integration_points:
  with_rita:
    - "Pattern selection during agent creation"
    - "Automatic evolution suggestions"
    - "Constraint score feedback"
    - "Success tracking"
    - "Orchestration pattern recommendations"

  with_kb:
    - "Store successful patterns in vector DB"
    - "Search for similar patterns"
    - "Extract patterns from existing agents"
    - "Index orchestration patterns"

  with_diagnostics:
    - "Constraint analyzer provides scores"
    - "Conflict resolver identifies issues"
    - "Metrics collector gathers data"
    - "Orchestration effectiveness tracking"

recent_extractions:
  last_extraction_date: "2025-08-22"
  extracted_patterns: 3
  source_success: "PM command orchestration fix"
  improvements_achieved:
    - "Eliminated discovery conflicts (100%)"
    - "Reduced KB load (60%)"
    - "Improved success rates (16% average)"
    - "Enhanced workflow efficiency (25-30%)"